language: python
sudo: false

branches:
  only:
    #- master
    - conda_install

install:
  - source devtools/travis-ci/install.sh
  # Add omnia channel
  - conda config --add channels ${ORGNAME}
  - conda create -n test python=$python
  - source activate test
  - conda build devtools/conda-recipe
  - export PYTHONUNBUFFERED=true

script:
 - source activate test
 - conda info -a
  #- cd devtools && nosetests -vv --nocapture --with-timer $PACKAGENAME && cd ..
 - cd blues/tests && $python pytest

env:
  matrix:
    - python=2.7  CONDA_PY=27
    #- python=3.4  CONDA_PY=34
    - python=3.5  CONDA_PY=35

  global:
    - ORGNAME="omnia"
    - PACKAGENAME="blues"

#after_success:
#  - echo "after_success"
#  - if [ "$TRAVIS_SECURE_ENV_VARS" == true ]; then ./devtools/travis-ci/after_success.sh; fi
