

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Modules &mdash; blues 0.2.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorial" href="tutorial.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> blues
          

          
            
            <img src="_static/blues-scaled.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#github">Github</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#publication">Publication</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#theory">Theory</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#stable-releases">Stable Releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#development-builds">Development Builds</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#source-installation">Source Installation</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-blues.moves">Moves</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#move">Move</a></li>
<li class="toctree-l3"><a class="reference internal" href="#randomligandrotationmove">RandomLigandRotationMove</a></li>
<li class="toctree-l3"><a class="reference internal" href="#moveengine">MoveEngine</a></li>
<li class="toctree-l3"><a class="reference internal" href="#under-development">Under Development</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-blues.simulation">Simulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#systemfactory">SystemFactory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#simulationfactory">SimulationFactory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bluessimulation">BLUESSimulation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-blues.integrators">Integrators</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-blues.utils">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-blues.reporters">Reporters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-blues.formats">Formats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="BLUES_tutorial.html">Introduction to BLUES</a></li>
<li class="toctree-l2"><a class="reference internal" href="BLUES_tutorial.html#Background">Background</a><ul>
<li class="toctree-l3"><a class="reference internal" href="BLUES_tutorial.html#Coupling-MD-simulations-with-random-NCMC-moves-for-enhanced-sampling-of-ligand-binding-modes-via-BLUES">Coupling MD simulations with random NCMC moves for enhanced sampling of ligand binding modes via BLUES</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="BLUES_tutorial.html#YAML-Configuration">YAML Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="BLUES_tutorial.html#Input/Output">Input/Output</a><ul>
<li class="toctree-l4"><a class="reference internal" href="BLUES_tutorial.html#Output-files">Output files</a></li>
<li class="toctree-l4"><a class="reference internal" href="BLUES_tutorial.html#Input-files-to-generate-the-structure-of-your-system">Input files to generate the structure of your system</a></li>
<li class="toctree-l4"><a class="reference internal" href="BLUES_tutorial.html#Restart-files">Restart files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="BLUES_tutorial.html#System-configuration">System configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="BLUES_tutorial.html#(Optional)-Hydrogen-mass-repartitioning">(Optional) Hydrogen mass repartitioning</a></li>
<li class="toctree-l4"><a class="reference internal" href="BLUES_tutorial.html#(Optional)-Alchemical-system-configuration">(Optional) Alchemical system configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="BLUES_tutorial.html#Simulation-Configuration">Simulation Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="BLUES_tutorial.html#NPT-Simulation">NPT Simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="BLUES_tutorial.html#(Optional)-Additional-relaxation-steps-in-the-NCMC-simulation">(Optional) Additional relaxation steps in the NCMC simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="BLUES_tutorial.html#(Optional)-Platform-Properties">(Optional) Platform Properties</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="BLUES_tutorial.html#Reporter-Configuration">Reporter Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="BLUES_tutorial.html#(Optional)-Advanced-options-to-the-``traj_netcdf``-reporter">(Optional) Advanced options to the <strong>``traj_netcdf``</strong> reporter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="BLUES_tutorial.html#Running-a-BLUES-simulation">Running a BLUES simulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="BLUES_tutorial.html#Selecting-a-move-and-initialize-the-move-engine">Selecting a move and initialize the move engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="BLUES_tutorial.html#Generating-the-Systems-for-openMM:-``SystemFactory``">Generating the Systems for openMM: <strong>``SystemFactory``</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="BLUES_tutorial.html#(Optional)-Applying-restraints-or-freezing-atoms">(Optional) Applying restraints or freezing atoms</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="BLUES_tutorial.html#Generating-the-OpenMM-Simulations:-``SimulationFactory``">Generating the OpenMM Simulations: <strong>``SimulationFactory``</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="BLUES_tutorial.html#Run-the-BLUES-Simulation">Run the BLUES Simulation</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">blues</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Modules</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/module_doc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="modules">
<h1>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-blues.moves">
<span id="moves"></span><h2>Moves<a class="headerlink" href="#module-blues.moves" title="Permalink to this headline">¶</a></h2>
<p>Provides the main Move class which allows definition of moves
which alter the positions of subsets of atoms in a context during a BLUES
simulation, in order to increase sampling.
Also provides functionality for CombinationMove definitions which consist of
a combination of other pre-defined moves such as via instances of Move.</p>
<p>Authors: Samuel C. Gill</p>
<p>Contributors: Nathan M. Lim, Kalistyn Burley, David L. Mobley</p>
<div class="section" id="move">
<h3>Move<a class="headerlink" href="#move" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="blues.moves.Move">
<em class="property">class </em><code class="descclassname">blues.moves.</code><code class="descname">Move</code><a class="reference internal" href="_modules/blues/moves.html#Move"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.Move" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the base Move class. Move provides methods for calculating properties
and applying the move on the set of atoms being perturbed in the NCMC simulation.</p>
<dl class="method">
<dt id="blues.moves.Move.initializeSystem">
<code class="descname">initializeSystem</code><span class="sig-paren">(</span><em>system</em>, <em>integrator</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#Move.initializeSystem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.Move.initializeSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>If the system or integrator needs to be modified to perform the move
(ex. adding a force) this method is called during the start
of the simulation to change the system or integrator to accomodate that.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>system</strong> (<em>openmm.System</em>) – System to be modified.</li>
<li><strong>integrator</strong> (<em>openmm.Integrator</em>) – Integrator to be modified.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>system</strong> (<em>openmm.System</em>) – The modified System object.</li>
<li><strong>integrator</strong> (<em>openmm.Integrator</em>) – The modified Integrator object.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.moves.Move.beforeMove">
<code class="descname">beforeMove</code><span class="sig-paren">(</span><em>context</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#Move.beforeMove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.Move.beforeMove" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called at the start of the NCMC portion if the
context needs to be checked or modified before performing the move
at the halfway point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>context</strong> (<em>openmm.Context</em>) – Context containing the positions to be moved.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>context</strong> (<em>openmm.Context</em>) – The same input context, but whose context were changed by this function.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.moves.Move.afterMove">
<code class="descname">afterMove</code><span class="sig-paren">(</span><em>context</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#Move.afterMove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.Move.afterMove" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called at the end of the NCMC portion if the
context needs to be checked or modified before performing the move
at the halfway point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>context</strong> (<em>openmm.Context</em>) – Context containing the positions to be moved.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>context</strong> (<em>openmm.Context</em>) – The same input context, but whose context were changed by this function.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.moves.Move.move">
<code class="descname">move</code><span class="sig-paren">(</span><em>context</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#Move.move"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.Move.move" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called at the end of the NCMC portion if the
context needs to be checked or modified before performing the move
at the halfway point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>context</strong> (<em>openmm.Context</em>) – Context containing the positions to be moved.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>context</strong> (<em>openmm.Context</em>) – The same input context, but whose context were changed by this function.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="randomligandrotationmove">
<h3>RandomLigandRotationMove<a class="headerlink" href="#randomligandrotationmove" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="blues.moves.RandomLigandRotationMove">
<em class="property">class </em><code class="descclassname">blues.moves.</code><code class="descname">RandomLigandRotationMove</code><span class="sig-paren">(</span><em>structure</em>, <em>resname='LIG'</em>, <em>random_state=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#RandomLigandRotationMove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.RandomLigandRotationMove" title="Permalink to this definition">¶</a></dt>
<dd><p>RandomLightRotationMove that provides methods for calculating properties on the
object ‘model’ (i.e ligand) being perturbed in the NCMC simulation.
Current methods calculate the object’s atomic masses and center of masss.
Calculating the object’s center of mass will get the positions
and total mass.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>resname</strong> (<em>str</em>) – String specifying the resiue name of the ligand.</li>
<li><strong>structure</strong> (<em>parmed.Structure</em>) – ParmEd Structure object of the relevant system to be moved.</li>
<li><strong>random_state</strong> (<em>integer or numpy.RandomState, optional</em>) – The generator used for random numbers. If an integer is given, it fixes the seed. Defaults to the global numpy random number generator.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="blues.moves.RandomLigandRotationMove.structure">
<code class="descname">structure</code><a class="headerlink" href="#blues.moves.RandomLigandRotationMove.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><em>parmed.Structure</em> – The structure of the ligand or selected atoms to be rotated.</p>
</dd></dl>

<dl class="attribute">
<dt id="blues.moves.RandomLigandRotationMove.resname">
<code class="descname">resname</code><a class="headerlink" href="#blues.moves.RandomLigandRotationMove.resname" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str, default=’LIG’</em> – The residue name of the ligand or selected atoms to be rotated.</p>
</dd></dl>

<dl class="attribute">
<dt id="blues.moves.RandomLigandRotationMove.topology">
<code class="descname">topology</code><a class="headerlink" href="#blues.moves.RandomLigandRotationMove.topology" title="Permalink to this definition">¶</a></dt>
<dd><p><em>openmm.Topology</em> – The topology of the ligand or selected atoms to be rotated.</p>
</dd></dl>

<dl class="attribute">
<dt id="blues.moves.RandomLigandRotationMove.atom_indices">
<code class="descname">atom_indices</code><a class="headerlink" href="#blues.moves.RandomLigandRotationMove.atom_indices" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em> – Atom indicies of the ligand.</p>
</dd></dl>

<dl class="attribute">
<dt id="blues.moves.RandomLigandRotationMove.masses">
<code class="descname">masses</code><a class="headerlink" href="#blues.moves.RandomLigandRotationMove.masses" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em> – Particle masses of the ligand with units.</p>
</dd></dl>

<dl class="attribute">
<dt id="blues.moves.RandomLigandRotationMove.totalmass">
<code class="descname">totalmass</code><a class="headerlink" href="#blues.moves.RandomLigandRotationMove.totalmass" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> – Total mass of the ligand.</p>
</dd></dl>

<dl class="attribute">
<dt id="blues.moves.RandomLigandRotationMove.center_of_mass">
<code class="descname">center_of_mass</code><a class="headerlink" href="#blues.moves.RandomLigandRotationMove.center_of_mass" title="Permalink to this definition">¶</a></dt>
<dd><p><em>numpy.array</em> – Calculated center of mass of the ligand in XYZ coordinates. This should
be updated every iteration.</p>
</dd></dl>

<dl class="attribute">
<dt id="blues.moves.RandomLigandRotationMove.positions">
<code class="descname">positions</code><a class="headerlink" href="#blues.moves.RandomLigandRotationMove.positions" title="Permalink to this definition">¶</a></dt>
<dd><p><em>numpy.array</em> – Ligands positions in XYZ coordinates. This should be updated
every iteration.</p>
</dd></dl>

<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">blues.move</span> <span class="k">import</span> <span class="n">RandomLigandRotationMove</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ligand</span> <span class="o">=</span> <span class="n">RandomLigandRotationMove</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="s1">&#39;LIG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ligand</span><span class="o">.</span><span class="n">resname</span>
<span class="go">    &#39;LIG&#39;</span>
</pre></div>
</div>
<dl class="method">
<dt id="blues.moves.RandomLigandRotationMove.getAtomIndices">
<code class="descname">getAtomIndices</code><span class="sig-paren">(</span><em>structure</em>, <em>resname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#RandomLigandRotationMove.getAtomIndices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.RandomLigandRotationMove.getAtomIndices" title="Permalink to this definition">¶</a></dt>
<dd><p>Get atom indices of a ligand from ParmEd Structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>resname</strong> (<em>str</em>) – String specifying the resiue name of the ligand.</li>
<li><strong>structure</strong> (<em>parmed.Structure</em>) – ParmEd Structure object of the atoms to be moved.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>atom_indices</strong> (<em>list of ints</em>) – list of atoms in the coordinate file matching lig_resname</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.moves.RandomLigandRotationMove.getMasses">
<code class="descname">getMasses</code><span class="sig-paren">(</span><em>topology</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#RandomLigandRotationMove.getMasses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.RandomLigandRotationMove.getMasses" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of masses of the specified ligand atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>topology</strong> (<em>parmed.Topology</em>) – ParmEd topology object containing atoms of the system.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>masses</strong> (<em>1xn numpy.array * simtk.unit.dalton</em>) – array of masses of len(self.atom_indices), denoting
the masses of the atoms in self.atom_indices</li>
<li><strong>totalmass</strong> (<em>float * simtk.unit.dalton</em>) – The sum of the mass found in masses</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.moves.RandomLigandRotationMove.getCenterOfMass">
<code class="descname">getCenterOfMass</code><span class="sig-paren">(</span><em>positions</em>, <em>masses</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#RandomLigandRotationMove.getCenterOfMass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.RandomLigandRotationMove.getCenterOfMass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the calculated center of mass of the ligand as a numpy.array</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>positions</strong> (<em>nx3 numpy array * simtk.unit compatible with simtk.unit.nanometers</em>) – ParmEd positions of the atoms to be moved.</li>
<li><strong>masses</strong> (<em>numpy.array</em>) – numpy.array of particle masses</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>center_of_mass</strong> (<em>numpy array * simtk.unit compatible with simtk.unit.nanometers</em>) – 1x3 numpy.array of the center of mass of the given positions</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.moves.RandomLigandRotationMove.move">
<code class="descname">move</code><span class="sig-paren">(</span><em>context</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#RandomLigandRotationMove.move"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.RandomLigandRotationMove.move" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that performs a random rotation about the
center of mass of the ligand.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>context</strong> (<em>simtk.openmm.Context object</em>) – Context containing the positions to be moved.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>context</strong> (<em>simtk.openmm.Context object</em>) – The same input context, but whose positions were changed by this function.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="moveengine">
<h3>MoveEngine<a class="headerlink" href="#moveengine" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="blues.moves.MoveEngine">
<em class="property">class </em><code class="descclassname">blues.moves.</code><code class="descname">MoveEngine</code><span class="sig-paren">(</span><em>moves</em>, <em>probabilities=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#MoveEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.MoveEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>MoveEngine provides perturbation functions for the context during the NCMC
simulation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>moves</strong> (<em>blues.move object or list of N blues.move objects</em>) – Specifies the possible moves to be performed.</li>
<li><strong>probabilities</strong> (<em>list of floats, optional, default=None</em>) – A list of N probabilities, where probabilities[i] corresponds to the
probaility of moves[i] being selected to perform its associated
move() method. If None, uniform probabilities are assigned.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="blues.moves.MoveEngine.moves">
<code class="descname">moves</code><a class="headerlink" href="#blues.moves.MoveEngine.moves" title="Permalink to this definition">¶</a></dt>
<dd><p><em>blues.move or list of N blues.move objects</em> – Possible moves to be performed.</p>
</dd></dl>

<dl class="attribute">
<dt id="blues.moves.MoveEngine.probabilities">
<code class="descname">probabilities</code><a class="headerlink" href="#blues.moves.MoveEngine.probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list of floats</em> – Normalized probabilities for each move.</p>
</dd></dl>

<dl class="attribute">
<dt id="blues.moves.MoveEngine.selected_move">
<code class="descname">selected_move</code><a class="headerlink" href="#blues.moves.MoveEngine.selected_move" title="Permalink to this definition">¶</a></dt>
<dd><p><em>blues.move</em> – Selected move to be performed.</p>
</dd></dl>

<dl class="attribute">
<dt id="blues.moves.MoveEngine.move_name">
<code class="descname">move_name</code><a class="headerlink" href="#blues.moves.MoveEngine.move_name" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – Name of the selected move to be performed</p>
</dd></dl>

<p class="rubric">Examples</p>
<p>Load a parmed.Structure, list of moves with probabilities, initialize
the MoveEngine class, and select a move from our list.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">parmed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">blues.moves</span> <span class="k">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structure</span> <span class="o">=</span> <span class="n">parmed</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s1">&#39;tests/data/eqToluene.prmtop&#39;</span><span class="p">,</span> <span class="n">xyz</span><span class="o">=</span><span class="s1">&#39;tests/data/eqToluene.inpcrd&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probabilities</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moves</span> <span class="o">=</span> <span class="p">[</span><span class="n">SideChainMove</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="p">[</span><span class="mi">111</span><span class="p">]),</span><span class="n">RandomLigandRotationMove</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="s1">&#39;LIG&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mover</span> <span class="o">=</span> <span class="n">MoveEngine</span><span class="p">(</span><span class="n">moves</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mover</span><span class="o">.</span><span class="n">moves</span>
<span class="go">[&lt;blues.moves.SideChainMove at 0x7f2eaa168470&gt;,</span>
<span class="go"> &lt;blues.moves.RandomLigandRotationMove at 0x7f2eaaaa51d0&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mover</span><span class="o">.</span><span class="n">selectMove</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mover</span><span class="o">.</span><span class="n">selected_move</span>
<span class="go">&lt;blues.moves.RandomLigandRotationMove at 0x7f2eaaaa51d0&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="blues.moves.MoveEngine.selectMove">
<code class="descname">selectMove</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#MoveEngine.selectMove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.MoveEngine.selectMove" title="Permalink to this definition">¶</a></dt>
<dd><p>Chooses the move which will be selected for a given NCMC
iteration</p>
</dd></dl>

<dl class="method">
<dt id="blues.moves.MoveEngine.runEngine">
<code class="descname">runEngine</code><span class="sig-paren">(</span><em>context</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#MoveEngine.runEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.MoveEngine.runEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Selects a random Move object based on its
assigned probability and and performs its move() function
on a context.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>context</strong> (<em>openmm.Context</em>) – OpenMM context whose positions should be moved.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>context</strong> (<em>openmm.Context</em>) – OpenMM context whose positions have been moved.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="under-development">
<h3>Under Development<a class="headerlink" href="#under-development" title="Permalink to this headline">¶</a></h3>
<p><strong>WARNING:</strong> The following move classes have not been tested. Use at your own risk.</p>
<dl class="class">
<dt id="blues.moves.SideChainMove">
<em class="property">class </em><code class="descclassname">blues.moves.</code><code class="descname">SideChainMove</code><span class="sig-paren">(</span><em>structure</em>, <em>residue_list</em>, <em>verbose=False</em>, <em>write_move=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#SideChainMove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.SideChainMove" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>NOTE:</strong> Usage of this class requires a valid OpenEye license.</p>
<p>SideChainMove provides methods for calculating properties needed to
rotate a sidechain residue given a parmed.Structure. Calculated properties
include: backbone atom indicies, atom pointers and indicies of the residue
sidechain, bond pointers and indices for rotatable heavy bonds in
the sidechain, and atom indices upstream of selected bond.</p>
<p>The class contains functions to randomly select a bond and angle to be rotated
and applies a rotation matrix to the target atoms to update their coordinates on the
object ‘model’ (i.e sidechain) being perturbed in the NCMC simulation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>structure</strong> (<em>parmed.Structure</em>) – The structure of the entire system to be simulated.</li>
<li><strong>residue_list</strong> (<em>list of int</em>) – List of the residue numbers of the sidechains to be rotated.</li>
<li><strong>verbose</strong> (<em>bool, default=False</em>) – Enable verbosity to print out detailed information of the rotation.</li>
<li><strong>write_move</strong> (<em>bool, default=False</em>) – If True, writes a PDB of the system after rotation.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="blues.moves.SideChainMove.structure">
<code class="descname">structure</code><a class="headerlink" href="#blues.moves.SideChainMove.structure" title="Permalink to this definition">¶</a></dt>
<dd><p><em>parmed.Structure</em> – The structure of the entire system to be simulated.</p>
</dd></dl>

<dl class="attribute">
<dt id="blues.moves.SideChainMove.molecule">
<code class="descname">molecule</code><a class="headerlink" href="#blues.moves.SideChainMove.molecule" title="Permalink to this definition">¶</a></dt>
<dd><p><em>oechem.OEMolecule</em> – The OEMolecule containing the sidechain(s) to be rotated.</p>
</dd></dl>

<dl class="attribute">
<dt id="blues.moves.SideChainMove.residue_list">
<code class="descname">residue_list</code><a class="headerlink" href="#blues.moves.SideChainMove.residue_list" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list of int</em> – List containing the residue numbers of the sidechains to be rotated.</p>
</dd></dl>

<dl class="attribute">
<dt id="blues.moves.SideChainMove.all_atoms">
<code class="descname">all_atoms</code><a class="headerlink" href="#blues.moves.SideChainMove.all_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list of int</em> – List containing the atom indicies of the sidechains to be rotated.</p>
</dd></dl>

<dl class="attribute">
<dt id="blues.moves.SideChainMove.rot_atoms">
<code class="descname">rot_atoms</code><a class="headerlink" href="#blues.moves.SideChainMove.rot_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> – Dictionary of residues, bonds and atoms to be rotated</p>
</dd></dl>

<dl class="attribute">
<dt id="blues.moves.SideChainMove.rot_bonds">
<code class="descname">rot_bonds</code><a class="headerlink" href="#blues.moves.SideChainMove.rot_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict of oechem.OEBondBase</em> – Dictionary containing the bond pointers of the rotatable bonds.</p>
</dd></dl>

<dl class="attribute">
<dt id="blues.moves.SideChainMove.qry_atoms">
<code class="descname">qry_atoms</code><a class="headerlink" href="#blues.moves.SideChainMove.qry_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict of oechem.OEAtomBase</em> – Dictionary containing all the atom pointers (as OpenEye objects) that
make up the given residues.</p>
</dd></dl>

<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">blues.move</span> <span class="k">import</span> <span class="n">SideChainMove</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sidechain</span> <span class="o">=</span> <span class="n">SideChainMove</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<dl class="method">
<dt id="blues.moves.SideChainMove.getBackboneAtoms">
<code class="descname">getBackboneAtoms</code><span class="sig-paren">(</span><em>molecule</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#SideChainMove.getBackboneAtoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.SideChainMove.getBackboneAtoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an OpenEye Molecule, finds the backbone atoms and
returns the indicies of the backbone atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>molecule</strong> (<em>oechem.OEMolecule</em>) – The OEmolecule of the simulated system.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>backbone_atoms</strong> (<em>list of int</em>) – List containing the atom indices of the backbone atoms.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.moves.SideChainMove.getTargetAtoms">
<code class="descname">getTargetAtoms</code><span class="sig-paren">(</span><em>molecule</em>, <em>backbone_atoms</em>, <em>residue_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#SideChainMove.getTargetAtoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.SideChainMove.getTargetAtoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an OpenEye molecule and a list of residue numbers then
generates a dictionary containing all the atom pointers and indicies for the
non-backbone, atoms of those target residues, as well as a list of backbone atoms.
Note: The atom indicies start at 0 and are thus -1 from the PDB file indicies</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molecule</strong> (<em>oechem.OEMolecule</em>) – The OEmolecule of the simulated system.</li>
<li><strong>backbone_atoms</strong> (<em>list of int</em>) – List containing the atom indices of the backbone atoms.</li>
<li><strong>residue_list</strong> (<em>list of int</em>) – List containing the residue numbers of the sidechains to be rotated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>backbone_atoms</strong> (<em>list of int</em>) – List containing the atom indices of the backbone atoms to be rotated.</li>
<li><strong>qry_atoms</strong> (<em>dict of oechem.OEAtomBase</em>) – Dictionary containing all the atom pointers (as OpenEye objects) that
make up the given residues.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.moves.SideChainMove.findHeavyRotBonds">
<code class="descname">findHeavyRotBonds</code><span class="sig-paren">(</span><em>pdb_OEMol</em>, <em>qry_atoms</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#SideChainMove.findHeavyRotBonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.SideChainMove.findHeavyRotBonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in an OpenEye molecule as well as a dictionary of atom locations (keys)
and atom indicies.  It loops over the query atoms and identifies any heavy bonds associated with each atom.
It stores and returns the bond indicies (keys) and the two atom indicies for each bond in a dictionary
Note: atom indicies start at 0, so are offset by 1 compared to pdb)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pdb_OEMol</strong> (<em>oechem.OEMolecule</em>) – The OEmolecule of the simulated system generated from a PDB file.</li>
<li><strong>qry_atoms</strong> (<em>dict of oechem.OEAtomBase</em>) – Dictionary containing all the atom pointers (as OpenEye objects) that
make up the given residues.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>rot_bonds</strong> (<em>dict of oechem.OEBondBase</em>) – Dictionary containing the bond pointers of the rotatable bonds.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.moves.SideChainMove.getRotAtoms">
<code class="descname">getRotAtoms</code><span class="sig-paren">(</span><em>rotbonds</em>, <em>molecule</em>, <em>backbone_atoms</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#SideChainMove.getRotAtoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.SideChainMove.getRotAtoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Function identifies and stores neighboring, upstream atoms for a given sidechain bond.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rot_bonds</strong> (<em>dict of oechem.OEBondBase</em>) – Dictionary containing the bond pointers of the rotatable bonds.</li>
<li><strong>molecule</strong> (<em>oechem.OEMolecule</em>) – The OEmolecule of the simulated system.</li>
<li><strong>backbone_atoms</strong> (<em>list of int</em>) – List containing the atom indices of the backbone atoms.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>rot_atom_dict</strong> (<em>dict of oechem.OEAtomBase</em>) – Dictionary containing the atom pointers for a given sidechain bond.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.moves.SideChainMove.getRotBondAtoms">
<code class="descname">getRotBondAtoms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#SideChainMove.getRotBondAtoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.SideChainMove.getRotBondAtoms" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is called on class initialization.</p>
<p>Takes in a PDB filename (as a string) and list of residue numbers.  Returns
a nested dictionary of rotatable bonds (containing only heavy atoms), that are keyed by residue number,
then keyed by bond pointer, containing values of atom indicies [axis1, axis2, atoms to be rotated]
Note: The atom indicies start at 0, and are offset by -1 from the PDB file indicies</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>rot_atoms</strong> (<em>dict</em>) – Dictionary of residues, bonds and atoms to be rotated</li>
<li><strong>rot_bonds</strong> (<em>dict of oechem.OEBondBase</em>) – Dictionary containing the bond pointers of the rotatable bonds.</li>
<li><strong>qry_atoms</strong> (<em>dict of oechem.OEAtomBase</em>) – Dictionary containing all the atom pointers (as OpenEye objects) that
make up the given residues.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.moves.SideChainMove.chooseBondandTheta">
<code class="descname">chooseBondandTheta</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#SideChainMove.chooseBondandTheta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.SideChainMove.chooseBondandTheta" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is called on class initialization.</p>
<p>Takes a dictionary containing nested dictionary, keyed by res#,
then keyed by bond_ptrs, containing a list of atoms to move, randomly selects a bond,
and generates a random angle (radians).  It returns the atoms associated with the
the selected bond, the pointer for the selected bond and the randomly generated angle</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>theta_ran</em></li>
<li><em>targetatoms</em></li>
<li><em>res_choice</em></li>
<li><em>bond_choice</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.moves.SideChainMove.rotation_matrix">
<code class="descname">rotation_matrix</code><span class="sig-paren">(</span><em>axis</em>, <em>theta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#SideChainMove.rotation_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.SideChainMove.rotation_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Function returns the rotation matrix associated with counterclockwise rotation
about the given axis by theta radians.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>axis</strong></li>
<li><strong>theta</strong> (<em>float</em>) – The angle of rotation in radians.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.moves.SideChainMove.move">
<code class="descname">move</code><span class="sig-paren">(</span><em>context</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#SideChainMove.move"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.SideChainMove.move" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the target atoms around a selected bond by angle theta and updates
the atom coordinates in the parmed structure as well as the ncmc context object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>context</strong> (<em>simtk.openmm.Context object</em>) – Context containing the positions to be moved.</li>
<li><strong>verbose</strong> (<em>bool, default=False</em>) – Enable verbosity to print out detailed information of the rotation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>context</strong> (<em>simtk.openmm.Context object</em>) – The same input context, but whose positions were changed by this function.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="blues.moves.SmartDartMove">
<em class="property">class </em><code class="descclassname">blues.moves.</code><code class="descname">SmartDartMove</code><span class="sig-paren">(</span><em>structure</em>, <em>basis_particles</em>, <em>coord_files</em>, <em>topology=None</em>, <em>dart_radius=Quantity(value=0.2</em>, <em>unit=nanometer)</em>, <em>self_dart=False</em>, <em>resname='LIG'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#SmartDartMove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.SmartDartMove" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>WARNING:</strong> This class has not been completely tested. Use at your own risk.</p>
<p>Move object that allows center of mass smart darting moves to be performed on a ligand,
allowing translations of a ligand between pre-defined regions in space. The
<cite>SmartDartMove.move()</cite> method translates the ligand to the locations of the ligand
found in the coord_files. These locations are defined in terms of the basis_particles.
These locations are picked with a uniform probability. Based on Smart Darting Monte Carlo <a class="reference internal" href="#smart-dart" id="id1">[smart-dart]</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>structure</strong> (<em>parmed.Structure</em>) – ParmEd Structure object of the relevant system to be moved.</li>
<li><strong>basis_particles</strong> (<em>list of 3 ints</em>) – Specifies the 3 indices of the protein whose coordinates will be used
to define a new set of basis vectors.</li>
<li><strong>coord_files</strong> (<em>list of str</em>) – List containing paths to coordinate files of the whole system for smart darting.</li>
<li><strong>topology</strong> (<em>str, optional, default=None</em>) – A path specifying a topology file matching the files in coord_files. Not
necessary if the coord_files already contain topologies (ex. PDBs).</li>
<li><strong>dart_radius</strong> (<em>simtk.unit float object compatible with simtk.unit.nanometers unit,</em>) – optional, default=0.2*simtk.unit.nanometers
The radius of the darting region around each dart.</li>
<li><strong>self_dart</strong> (<em>boolean, optional, default=’False’</em>) – When performing the center of mass darting in <cite>SmartDartMove.move()</cite>,this
specifies whether or not to include the darting region where the center
of mass currently resides as an option to dart to.</li>
<li><strong>resname</strong> (<em>str, optional, default=’LIG’</em>) – String specifying the residue name of the ligand.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="smart-dart" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[smart-dart]</a></td><td>I. Andricioaei, J. E. Straub, and A. F. Voter, J. Chem. Phys. 114, 6994 (2001).
<a class="reference external" href="https://doi.org/10.1063/1.1358861">https://doi.org/10.1063/1.1358861</a></td></tr>
</tbody>
</table>
<dl class="method">
<dt id="blues.moves.SmartDartMove.dartsFromParmEd">
<code class="descname">dartsFromParmEd</code><span class="sig-paren">(</span><em>coord_files</em>, <em>topology=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#SmartDartMove.dartsFromParmEd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.SmartDartMove.dartsFromParmEd" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to setup darts from a generic coordinate file, through MDtraj using the basis_particles to define
new basis vectors, which allows dart centers to remain consistant through a simulation.
This adds to the self.n_dartboard, which defines the centers used for smart darting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>coord_files</strong> (<em>list of str</em>) – List containing coordinate files of the whole system for smart darting.</li>
<li><strong>topology</strong> (<em>str, optional, default=None</em>) – A path specifying a topology file matching the files in coord_files. Not
necessary if the coord_files already contain topologies.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.moves.SmartDartMove.move">
<code class="descname">move</code><span class="sig-paren">(</span><em>context</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#SmartDartMove.move"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.SmartDartMove.move" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for performing smart darting move with darts that
depend on particle positions in the system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>context</strong> (<em>simtk.openmm.Context object</em>) – Context containing the positions to be moved.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>context</strong> (<em>simtk.openmm.Context object</em>) – The same input context, but whose positions were changed by this function.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="blues.moves.CombinationMove">
<em class="property">class </em><code class="descclassname">blues.moves.</code><code class="descname">CombinationMove</code><span class="sig-paren">(</span><em>moves</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#CombinationMove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.CombinationMove" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>WARNING:</strong> This class has not been completely tested. Use at your own risk.</p>
<p>Move object that allows Move object moves to be performed according to
the order in move_list. To ensure detailed balance, the moves have an equal
chance to be performed in listed or reverse order.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>moves</strong> (<em>list of blues.move.Move</em>)</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="blues.moves.CombinationMove.move">
<code class="descname">move</code><span class="sig-paren">(</span><em>context</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/moves.html#CombinationMove.move"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.moves.CombinationMove.move" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the move() functions of the Moves in move_list on
a context.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>context</strong> (<em>simtk.openmm.Context object</em>) – Context containing the positions to be moved.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>context</strong> (<em>simtk.openmm.Context object</em>) – The same input context, but whose positions were changed by this function.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-blues.simulation">
<span id="simulation"></span><h2>Simulation<a class="headerlink" href="#module-blues.simulation" title="Permalink to this headline">¶</a></h2>
<p>Provides classes for setting up and running the BLUES simulation.</p>
<ul class="simple">
<li><cite>SystemFactory</cite> : setup and modifying the OpenMM System prior to the simulation.</li>
<li><cite>SimulationFactory</cite> : generates the OpenMM Simulations from the System.</li>
<li><cite>BLUESSimulation</cite> : runs the NCMC+MD hybrid simulation.</li>
<li><cite>MonteCarloSimulation</cite> : runs a pure Monte Carlo simulation.</li>
</ul>
<p>Authors: Samuel C. Gill
Contributors: Nathan M. Lim, Meghan Osato, David L. Mobley</p>
<div class="section" id="systemfactory">
<h3>SystemFactory<a class="headerlink" href="#systemfactory" title="Permalink to this headline">¶</a></h3>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#blues.simulation.SystemFactory.amber_selection_to_atomidx" title="blues.simulation.SystemFactory.amber_selection_to_atomidx"><code class="xref py py-obj docutils literal notranslate"><span class="pre">amber_selection_to_atomidx</span></code></a>(structure,&nbsp;selection)</td>
<td>Converts AmberMask selection <a class="reference internal" href="#amber-syntax" id="id2">[amber-syntax]</a> to list of atom indices.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#blues.simulation.SystemFactory.atomidx_to_atomlist" title="blues.simulation.SystemFactory.atomidx_to_atomlist"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atomidx_to_atomlist</span></code></a>(structure,&nbsp;mask_idx)</td>
<td>Goes through the structure and matches the previously selected atom indices to the atom type.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#blues.simulation.SystemFactory.freeze_atoms" title="blues.simulation.SystemFactory.freeze_atoms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">freeze_atoms</span></code></a>(structure,&nbsp;system[,&nbsp;…])</td>
<td>Zeroes the masses of atoms from the given parmed selection <a class="reference internal" href="#amber-syntax" id="id3">[amber-syntax]</a>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#blues.simulation.SystemFactory.freeze_radius" title="blues.simulation.SystemFactory.freeze_radius"><code class="xref py py-obj docutils literal notranslate"><span class="pre">freeze_radius</span></code></a>(structure,&nbsp;system[,&nbsp;…])</td>
<td>Zero the masses of atoms outside the given raidus of the <cite>freeze_center</cite> parmed selection <a class="reference internal" href="#amber-syntax" id="id4">[amber-syntax]</a>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#blues.simulation.SystemFactory.generateAlchSystem" title="blues.simulation.SystemFactory.generateAlchSystem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generateAlchSystem</span></code></a>(system,&nbsp;atom_indices[,&nbsp;…])</td>
<td>Returns the OpenMM System for alchemical perturbations.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#blues.simulation.SystemFactory.generateSystem" title="blues.simulation.SystemFactory.generateSystem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generateSystem</span></code></a>(structure,&nbsp;**kwargs)</td>
<td>Construct an OpenMM System representing the topology described by the prmtop file.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#blues.simulation.SystemFactory.restrain_positions" title="blues.simulation.SystemFactory.restrain_positions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">restrain_positions</span></code></a>(structure,&nbsp;system[,&nbsp;…])</td>
<td>Applies positional restraints to atoms in the openmm.System by the given parmed selection <a class="reference internal" href="#amber-syntax" id="id5">[amber-syntax]</a>.</td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="blues.simulation.SystemFactory">
<em class="property">class </em><code class="descclassname">blues.simulation.</code><code class="descname">SystemFactory</code><span class="sig-paren">(</span><em>structure</em>, <em>atom_indices</em>, <em>config=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#SystemFactory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.SystemFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>SystemFactory contains methods to generate/modify the OpenMM System object
required for generating the openmm.Simulation using a given
parmed.Structure()</p>
<p class="rubric">Examples</p>
<p>Load Parmed Structure, select move type, initialize <cite>MoveEngine</cite>, and
generate the openmm.Systems</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">structure</span> <span class="o">=</span> <span class="n">parmed</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s1">&#39;eqToluene.prmtop&#39;</span><span class="p">,</span> <span class="n">xyz</span><span class="o">=</span><span class="s1">&#39;eqToluene.inpcrd&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ligand</span> <span class="o">=</span> <span class="n">RandomLigandRotationMove</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="s1">&#39;LIG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ligand_mover</span> <span class="o">=</span> <span class="n">MoveEngine</span><span class="p">(</span><span class="n">ligand</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">systems</span> <span class="o">=</span> <span class="n">SystemFactory</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">ligand</span><span class="o">.</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>The MD and alchemical Systems are generated and stored as an attribute</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">systems</span><span class="o">.</span><span class="n">md</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">systems</span><span class="o">.</span><span class="n">alch</span>
</pre></div>
</div>
<p>Freeze atoms in the alchemical system</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">systems</span><span class="o">.</span><span class="n">alch</span> <span class="o">=</span> <span class="n">SystemFactory</span><span class="o">.</span><span class="n">freeze_atoms</span><span class="p">(</span><span class="n">systems</span><span class="o">.</span><span class="n">alch</span><span class="p">,</span>
<span class="go">                                        freeze_distance=5.0,</span>
<span class="go">                                        freeze_center=&#39;LIG&#39;</span>
<span class="go">                                        freeze_solvent=&#39;HOH,NA,CL&#39;)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>structure</strong> (<em>parmed.Structure</em>) – A chemical structure composed of atoms, bonds, angles, torsions, and
other topological features.</li>
<li><strong>atom_indices</strong> (<em>list of int</em>) – Atom indicies of the move or designated for which the nonbonded forces
(both sterics and electrostatics components) have to be alchemically
modified.</li>
<li><strong>config</strong> (dict, parameters for generating the <cite>openmm.System</cite> for the MD) – and NCMC simulation. For complete parameters, see docs for <cite>generateSystem</cite>
and <cite>generateAlchSystem</cite></li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="staticmethod">
<dt id="blues.simulation.SystemFactory.amber_selection_to_atomidx">
<em class="property">static </em><code class="descname">amber_selection_to_atomidx</code><span class="sig-paren">(</span><em>structure</em>, <em>selection</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#SystemFactory.amber_selection_to_atomidx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.SystemFactory.amber_selection_to_atomidx" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts AmberMask selection <a class="reference internal" href="#amber-syntax" id="id6">[amber-syntax]</a> to list of atom indices.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>structure</strong> (<em>parmed.Structure()</em>) – Structure of the system, used for atom selection.</li>
<li><strong>selection</strong> (<em>str</em>) – AmberMask selection that gets converted to a list of atom indices.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>mask_idx</strong> (<em>list of int</em>) – List of atom indices.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="amber-syntax" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[amber-syntax]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id3">2</a>, <a class="fn-backref" href="#id4">3</a>, <a class="fn-backref" href="#id5">4</a>, <a class="fn-backref" href="#id6">5</a>, <a class="fn-backref" href="#id8">6</a>, <a class="fn-backref" href="#id9">7</a>, <a class="fn-backref" href="#id10">8</a>)</em> <ol class="last upperalpha simple" start="10">
<li>Swails, ParmEd Documentation (2015). <a class="reference external" href="http://parmed.github.io/ParmEd/html/amber.html#amber-mask-syntax">http://parmed.github.io/ParmEd/html/amber.html#amber-mask-syntax</a></li>
</ol>
</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="blues.simulation.SystemFactory.atomidx_to_atomlist">
<em class="property">static </em><code class="descname">atomidx_to_atomlist</code><span class="sig-paren">(</span><em>structure</em>, <em>mask_idx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#SystemFactory.atomidx_to_atomlist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.SystemFactory.atomidx_to_atomlist" title="Permalink to this definition">¶</a></dt>
<dd><p>Goes through the structure and matches the previously selected atom
indices to the atom type.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>structure</strong> (<em>parmed.Structure()</em>) – Structure of the system, used for atom selection.</li>
<li><strong>mask_idx</strong> (<em>list of int</em>) – List of atom indices.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>atom_list</strong> (<em>list of atoms</em>) – The atoms that were previously selected in mask_idx.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="blues.simulation.SystemFactory.generateSystem">
<em class="property">classmethod </em><code class="descname">generateSystem</code><span class="sig-paren">(</span><em>structure</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#SystemFactory.generateSystem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.SystemFactory.generateSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an OpenMM System representing the topology described by the
prmtop file. This function is just a wrapper for parmed Structure.createSystem().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>structure</strong> (<em>parmed.Structure()</em>) – The parmed.Structure of the molecular system to be simulated</li>
<li><strong>nonbondedMethod</strong> (<em>cutoff method</em>) – This is the cutoff method. It can be either the NoCutoff,
CutoffNonPeriodic, CutoffPeriodic, PME, or Ewald objects from the
simtk.openmm.app namespace</li>
<li><strong>nonbondedCutoff</strong> (<em>float or distance Quantity</em>) – The nonbonded cutoff must be either a floating point number
(interpreted as nanometers) or a Quantity with attached units. This
is ignored if nonbondedMethod is NoCutoff.</li>
<li><strong>switchDistance</strong> (<em>float or distance Quantity</em>) – The distance at which the switching function is turned on for van
der Waals interactions. This is ignored when no cutoff is used, and
no switch is used if switchDistance is 0, negative, or greater than
the cutoff</li>
<li><strong>constraints</strong> (<em>None, app.HBonds, app.HAngles, or app.AllBonds</em>) – Which type of constraints to add to the system (e.g., SHAKE). None
means no bonds are constrained. HBonds means bonds with hydrogen are
constrained</li>
<li><strong>rigidWater</strong> (<em>bool=True</em>) – If True, water is kept rigid regardless of the value of constraints.
A value of False is ignored if constraints is not None.</li>
<li><strong>implicitSolvent</strong> (<em>None, app.HCT, app.OBC1, app.OBC2, app.GBn, app.GBn2</em>) – The Generalized Born implicit solvent model to use.</li>
<li><strong>implicitSolventKappa</strong> (<em>float or 1/distance Quantity = None</em>) – This is the Debye kappa property related to modeling saltwater
conditions in GB. It should have units of 1/distance (1/nanometers
is assumed if no units present). A value of None means that kappa
will be calculated from implicitSolventSaltConc (below)</li>
<li><strong>implicitSolventSaltConc</strong> (<em>float or amount/volume Quantity=0 moles/liter</em>) – If implicitSolventKappa is None, the kappa will be computed from the
salt concentration. It should have units compatible with mol/L</li>
<li><strong>temperature</strong> (<em>float or temperature Quantity = 298.15 kelvin</em>) – This is only used to compute kappa from implicitSolventSaltConc</li>
<li><strong>soluteDielectric</strong> (<em>float=1.0</em>) – The dielectric constant of the protein interior used in GB</li>
<li><strong>solventDielectric</strong> (<em>float=78.5</em>) – The dielectric constant of the water used in GB</li>
<li><strong>useSASA</strong> (<em>bool=False</em>) – If True, use the ACE non-polar solvation model. Otherwise, use no
SASA-based nonpolar solvation model.</li>
<li><strong>removeCMMotion</strong> (<em>bool=True</em>) – If True, the center-of-mass motion will be removed periodically
during the simulation. If False, it will not.</li>
<li><strong>hydrogenMass</strong> (<em>float or mass quantity = None</em>) – If not None, hydrogen masses will be changed to this mass and the
difference subtracted from the attached heavy atom (hydrogen mass
repartitioning)</li>
<li><strong>ewaldErrorTolerance</strong> (<em>float=0.0005</em>) – When using PME or Ewald, the Ewald parameters will be calculated
from this value</li>
<li><strong>flexibleConstraints</strong> (<em>bool=True</em>) – If False, the energies and forces from the constrained degrees of
freedom will NOT be computed. If True, they will (but those degrees
of freedom will <em>still</em> be constrained).</li>
<li><strong>verbose</strong> (<em>bool=False</em>) – If True, the progress of this subroutine will be printed to stdout</li>
<li><strong>splitDihedrals</strong> (<em>bool=False</em>) – If True, the dihedrals will be split into two forces – proper and
impropers. This is primarily useful for debugging torsion parameter
assignments.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><em>openmm.System</em> – System formatted according to the prmtop file.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This function calls prune_empty_terms if any Topology lists have
changed.</p>
</dd></dl>

<dl class="classmethod">
<dt id="blues.simulation.SystemFactory.generateAlchSystem">
<em class="property">classmethod </em><code class="descname">generateAlchSystem</code><span class="sig-paren">(</span><em>system</em>, <em>atom_indices</em>, <em>softcore_alpha=0.5</em>, <em>softcore_a=1</em>, <em>softcore_b=1</em>, <em>softcore_c=6</em>, <em>softcore_beta=0.0</em>, <em>softcore_d=1</em>, <em>softcore_e=1</em>, <em>softcore_f=2</em>, <em>annihilate_electrostatics=True</em>, <em>annihilate_sterics=False</em>, <em>disable_alchemical_dispersion_correction=True</em>, <em>alchemical_pme_treatment='direct-space'</em>, <em>suppress_warnings=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#SystemFactory.generateAlchSystem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.SystemFactory.generateAlchSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the OpenMM System for alchemical perturbations.
This function calls <cite>openmmtools.alchemy.AbsoluteAlchemicalFactory</cite> and
<cite>openmmtools.alchemy.AlchemicalRegion</cite> to generate the System for the
NCMC simulation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>system</strong> (<em>openmm.System</em>) – The OpenMM System object corresponding to the reference system.</li>
<li><strong>atom_indices</strong> (<em>list of int</em>) – Atom indicies of the move or designated for which the nonbonded forces
(both sterics and electrostatics components) have to be alchemically
modified.</li>
<li><strong>annihilate_electrostatics</strong> (<em>bool, optional</em>) – If True, electrostatics should be annihilated, rather than decoupled
(default is True).</li>
<li><strong>annihilate_sterics</strong> (<em>bool, optional</em>) – If True, sterics (Lennard-Jones or Halgren potential) will be annihilated,
rather than decoupled (default is False).</li>
<li><strong>softcore_alpha</strong> (<em>float, optional</em>) – Alchemical softcore parameter for Lennard-Jones (default is 0.5).</li>
<li><strong>softcore_a, softcore_b, softcore_c</strong> (<em>float, optional</em>) – Parameters modifying softcore Lennard-Jones form. Introduced in
Eq. 13 of Ref. <a class="reference internal" href="#ttpham-jchemphys135-2011" id="id7">[TTPham-JChemPhys135-2011]</a> (default is 1).</li>
<li><strong>softcore_beta</strong> (<em>float, optional</em>) – Alchemical softcore parameter for electrostatics. Set this to zero
to recover standard electrostatic scaling (default is 0.0).</li>
<li><strong>softcore_d, softcore_e, softcore_f</strong> (<em>float, optional</em>) – Parameters modifying softcore electrostatics form (default is 1).</li>
<li><strong>disable_alchemical_dispersion_correction</strong> (<em>bool, optional, default=True</em>) – If True, the long-range dispersion correction will not be included for the alchemical
region to avoid the need to recompute the correction (a CPU operation that takes ~ 0.5 s)
every time ‘lambda_sterics’ is changed. If using nonequilibrium protocols, it is recommended
that this be set to True since this can lead to enormous (100x) slowdowns if the correction
must be recomputed every time step.</li>
<li><strong>alchemical_pme_treatment</strong> (<em>str, optional, default = ‘direct-space’</em>) – Controls how alchemical region electrostatics are treated when PME is used.
Options are ‘direct-space’, ‘coulomb’, ‘exact’.
- ‘direct-space’ only models the direct space contribution
- ‘coulomb’ includes switched Coulomb interaction
- ‘exact’ includes also the reciprocal space contribution, but it’s
only possible to annihilate the charges and the softcore parameters
controlling the electrostatics are deactivated. Also, with this
method, modifying the global variable <cite>lambda_electrostatics</cite> is
not sufficient to control the charges. The recommended way to change
them is through the <cite>AlchemicalState</cite> class.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>alch_system</strong> (<em>alchemical_system</em>) – System to be used for the NCMC simulation.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="ttpham-jchemphys135-2011" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[TTPham-JChemPhys135-2011]</a></td><td><ol class="first last upperalpha simple" start="20">
<li><ol class="first upperalpha" start="20">
<li>Pham and M. R. Shirts, J. Chem. Phys 135, 034114 (2011). <a class="reference external" href="http://dx.doi.org/10.1063/1.3607597">http://dx.doi.org/10.1063/1.3607597</a></li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="blues.simulation.SystemFactory.restrain_positions">
<em class="property">classmethod </em><code class="descname">restrain_positions</code><span class="sig-paren">(</span><em>structure</em>, <em>system</em>, <em>selection='(&#64;CA</em>, <em>C</em>, <em>N)'</em>, <em>weight=5.0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#SystemFactory.restrain_positions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.SystemFactory.restrain_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies positional restraints to atoms in the openmm.System
by the given parmed selection <a class="reference internal" href="#amber-syntax" id="id8">[amber-syntax]</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>system</strong> (<em>openmm.System</em>) – The OpenMM System object to be modified.</li>
<li><strong>structure</strong> (<em>parmed.Structure()</em>) – Structure of the system, used for atom selection.</li>
<li><strong>selection</strong> (<em>str, Default = “(&#64;CA,C,N)”</em>) – AmberMask selection to apply positional restraints to</li>
<li><strong>weight</strong> (<em>float, Default = 5.0</em>) – Restraint weight for xyz atom restraints in kcal/(mol A^2)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>system</strong> (<em>openmm.System</em>) – Modified with positional restraints applied.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="blues.simulation.SystemFactory.freeze_atoms">
<em class="property">classmethod </em><code class="descname">freeze_atoms</code><span class="sig-paren">(</span><em>structure</em>, <em>system</em>, <em>freeze_selection=':LIG'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#SystemFactory.freeze_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.SystemFactory.freeze_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Zeroes the masses of atoms from the given parmed selection <a class="reference internal" href="#amber-syntax" id="id9">[amber-syntax]</a>.
Massless atoms will be ignored by the integrator and will not change
positions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>system</strong> (<em>openmm.System</em>) – The OpenMM System object to be modified.</li>
<li><strong>structure</strong> (<em>parmed.Structure()</em>) – Structure of the system, used for atom selection.</li>
<li><strong>freeze_selection</strong> (<em>str, Default = “:LIG”</em>) – AmberMask selection for the center in which to select atoms for
zeroing their massesself.
Defaults to freezing protein backbone atoms.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>system</strong> (<em>openmm.System</em>) – The modified system with the selected atoms</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="blues.simulation.SystemFactory.freeze_radius">
<em class="property">classmethod </em><code class="descname">freeze_radius</code><span class="sig-paren">(</span><em>structure</em>, <em>system</em>, <em>freeze_distance=Quantity(value=5.0</em>, <em>unit=angstrom)</em>, <em>freeze_center=':LIG'</em>, <em>freeze_solvent=':HOH</em>, <em>NA</em>, <em>CL'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#SystemFactory.freeze_radius"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.SystemFactory.freeze_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Zero the masses of atoms outside the given raidus of
the <cite>freeze_center</cite> parmed selection <a class="reference internal" href="#amber-syntax" id="id10">[amber-syntax]</a>. Massless atoms will be ignored by the
integrator and will not change positions.This is intended to freeze
the solvent and protein atoms around the ligand binding site.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>system</strong> (<em>openmm.System</em>) – The OpenMM System object to be modified.</li>
<li><strong>structure</strong> (<em>parmed.Structure()</em>) – Structure of the system, used for atom selection.</li>
<li><strong>freeze_distance</strong> (<em>float, Default = 5.0</em>) – Distance (angstroms) to select atoms for retaining their masses.
Atoms outside the set distance will have their masses set to 0.0.</li>
<li><strong>freeze_center</strong> (<em>str, Default = “:LIG”</em>) – AmberMask selection for the center in which to select atoms for
zeroing their masses. Default: LIG</li>
<li><strong>freeze_solvent</strong> (<em>str, Default = “:HOH,NA,CL”</em>) – AmberMask selection in which to select solvent atoms for zeroing
their masses.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>system</strong> (<em>openmm.System</em>) – Modified system with masses outside the <cite>freeze center</cite> zeroed.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="simulationfactory">
<h3>SimulationFactory<a class="headerlink" href="#simulationfactory" title="Permalink to this headline">¶</a></h3>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#blues.simulation.SimulationFactory.addBarostat" title="blues.simulation.SimulationFactory.addBarostat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">addBarostat</span></code></a>(system[,&nbsp;temperature,&nbsp;unit,&nbsp;…])</td>
<td>Adds a MonteCarloBarostat to the MD system.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#blues.simulation.SimulationFactory.attachReporters" title="blues.simulation.SimulationFactory.attachReporters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">attachReporters</span></code></a>(simulation,&nbsp;reporter_list)</td>
<td>Attach the list of reporters to the Simulation object</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#blues.simulation.SimulationFactory.generateIntegrator" title="blues.simulation.SimulationFactory.generateIntegrator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generateIntegrator</span></code></a>([temperature,&nbsp;unit,&nbsp;dt,&nbsp;…])</td>
<td>Generates a LangevinIntegrator for the Simulations.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#blues.simulation.SimulationFactory.generateNCMCIntegrator" title="blues.simulation.SimulationFactory.generateNCMCIntegrator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generateNCMCIntegrator</span></code></a>([nstepsNC,&nbsp;…])</td>
<td>Generates the AlchemicalExternalLangevinIntegrator using openmmtools.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#blues.simulation.SimulationFactory.generateSimFromStruct" title="blues.simulation.SimulationFactory.generateSimFromStruct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generateSimFromStruct</span></code></a>(structure,&nbsp;system,&nbsp;…)</td>
<td>Generate the OpenMM Simulation objects from a given parmed.Structure()</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#blues.simulation.SimulationFactory.generateSimulationSet" title="blues.simulation.SimulationFactory.generateSimulationSet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generateSimulationSet</span></code></a>([config])</td>
<td>Generates the 3 OpenMM Simulation objects.</td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="blues.simulation.SimulationFactory">
<em class="property">class </em><code class="descclassname">blues.simulation.</code><code class="descname">SimulationFactory</code><span class="sig-paren">(</span><em>systems</em>, <em>move_engine</em>, <em>config=None</em>, <em>md_reporters=None</em>, <em>ncmc_reporters=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#SimulationFactory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.SimulationFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>SimulationFactory is used to generate the 3 required OpenMM Simulation
objects (MD, NCMC, ALCH) required for the BLUES run. This class can take a
list of reporters for the MD or NCMC simulation in the arguments
<cite>md_reporters</cite> or <cite>ncmc_reporters</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>systems</strong> (<em>blues.simulation.SystemFactory object</em>) – The object containing the MD and alchemical openmm.Systems</li>
<li><strong>move_engine</strong> (<em>blues.moves.MoveEngine object</em>) – MoveEngine object which contains the list of moves performed
in the NCMC simulation.</li>
<li><strong>config</strong> (<em>dict</em>) – Simulation parameters which include:
nIter, nstepsNC, nstepsMD, nprop, propLambda, temperature, dt, propSteps, write_move</li>
<li><strong>md_reporters</strong> (<em>(optional) list of Reporter objects for the MD openmm.Simulation</em>)</li>
<li><strong>ncmc_reporters</strong> (<em>(optional) list of Reporter objects for the NCMC openmm.Simulation</em>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Load Parmed Structure from our input files, select the move type,
initialize the MoveEngine, and generate the openmm systems.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">structure</span> <span class="o">=</span> <span class="n">parmed</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s1">&#39;eqToluene.prmtop&#39;</span><span class="p">,</span> <span class="n">xyz</span><span class="o">=</span><span class="s1">&#39;eqToluene.inpcrd&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ligand</span> <span class="o">=</span> <span class="n">RandomLigandRotationMove</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="s1">&#39;LIG&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ligand_mover</span> <span class="o">=</span> <span class="n">MoveEngine</span><span class="p">(</span><span class="n">ligand</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">systems</span> <span class="o">=</span> <span class="n">SystemFactory</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">ligand</span><span class="o">.</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Now, we can generate the Simulations from our openmm Systems using the
SimulationFactory class. If a configuration is provided at on initialization,
it will call <cite>generateSimulationSet()</cite> for convenience. Otherwise, the class can be
instantiated like a normal python class.</p>
<p>Below is an example of initializing the class like a normal python object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">simulations</span> <span class="o">=</span> <span class="n">SimulationFactory</span><span class="p">(</span><span class="n">systems</span><span class="p">,</span> <span class="n">ligand_mover</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hasattr</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="s1">&#39;md&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hasattr</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="s1">&#39;ncmc&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Below, we provide a dict for configuring the Simulations and then
generate them by calling <cite>simulations.generateSimulationSet()</cite>. The MD/NCMC
simulation objects can be accessed separately as class attributes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim_cfg</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;platform&#39;</span><span class="p">:</span> <span class="s1">&#39;OpenCL&#39;</span><span class="p">,</span>
<span class="go">            &#39;properties&#39; : { &#39;OpenCLPrecision&#39;: &#39;single&#39;,</span>
<span class="go">                             &#39;OpenCLDeviceIndex&#39; : 2},</span>
<span class="go">            &#39;nprop&#39; : 1,</span>
<span class="go">            &#39;propLambda&#39; : 0.3,</span>
<span class="go">            &#39;dt&#39; : 0.001 * unit.picoseconds,</span>
<span class="go">            &#39;friction&#39; : 1 * 1/unit.picoseconds,</span>
<span class="go">            &#39;temperature&#39; : 100 * unit.kelvin,</span>
<span class="go">            &#39;nIter&#39;: 1,</span>
<span class="go">            &#39;nstepsMD&#39;: 10,</span>
<span class="go">            &#39;nstepsNC&#39;: 10,}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simulations</span><span class="o">.</span><span class="n">generateSimulationSet</span><span class="p">(</span><span class="n">sim_cfg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hasattr</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="s1">&#39;md&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hasattr</span><span class="p">(</span><span class="n">simulations</span><span class="p">,</span> <span class="s1">&#39;ncmc&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>After generating the Simulations, attach your own reporters by providing
the reporters in a list. Be sure to attach to either the MD or NCMC simulation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">simtk.openmm.app</span> <span class="k">import</span> <span class="n">StateDataReporter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md_reporters</span> <span class="o">=</span> <span class="p">[</span> <span class="n">StateDataReporter</span><span class="p">(</span><span class="s1">&#39;test.log&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncmc_reporters</span> <span class="o">=</span> <span class="p">[</span> <span class="n">StateDataReporter</span><span class="p">(</span><span class="s1">&#39;test-ncmc.log&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simulations</span><span class="o">.</span><span class="n">md</span> <span class="o">=</span> <span class="n">simulations</span><span class="o">.</span><span class="n">attachReporters</span><span class="p">(</span> <span class="n">simulations</span><span class="o">.</span><span class="n">md</span><span class="p">,</span> <span class="n">md_reporters</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simulations</span><span class="o">.</span><span class="n">ncmc</span> <span class="o">=</span> <span class="n">simulations</span><span class="o">.</span><span class="n">attachReporters</span><span class="p">(</span> <span class="n">simulations</span><span class="o">.</span><span class="n">ncmc</span><span class="p">,</span> <span class="n">ncmc_reporters</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively, you can pass the configuration dict and list of reporters
upon class initialization. This will do all of the above for convenience.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">simulations</span> <span class="o">=</span> <span class="n">SimulationFactory</span><span class="p">(</span><span class="n">systems</span><span class="p">,</span> <span class="n">ligand_mover</span><span class="p">,</span> <span class="n">sim_cfg</span><span class="p">,</span>
<span class="go">                                    md_reporters, ncmc_reporters)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">simulations</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">simulations</span><span class="o">.</span><span class="n">md</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">simulations</span><span class="o">.</span><span class="n">ncmc</span><span class="p">)</span>
<span class="go">&lt;blues.simulation.SimulationFactory object at 0x7f461b7a8b00&gt;</span>
<span class="go">&lt;simtk.openmm.app.simulation.Simulation object at 0x7f461b7a8780&gt;</span>
<span class="go">&lt;simtk.openmm.app.simulation.Simulation object at 0x7f461b7a87b8&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">simulations</span><span class="o">.</span><span class="n">md</span><span class="o">.</span><span class="n">reporters</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">simulations</span><span class="o">.</span><span class="n">ncmc</span><span class="o">.</span><span class="n">reporters</span><span class="p">)</span>
<span class="go">[&lt;simtk.openmm.app.statedatareporter.StateDataReporter object at 0x7f1b4d24cac8&gt;]</span>
<span class="go">[&lt;simtk.openmm.app.statedatareporter.StateDataReporter object at 0x7f1b4d24cb70&gt;]</span>
</pre></div>
</div>
<dl class="classmethod">
<dt id="blues.simulation.SimulationFactory.addBarostat">
<em class="property">classmethod </em><code class="descname">addBarostat</code><span class="sig-paren">(</span><em>system</em>, <em>temperature=Quantity(value=300</em>, <em>unit=kelvin)</em>, <em>pressure=Quantity(value=1</em>, <em>unit=atmosphere)</em>, <em>frequency=25</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#SimulationFactory.addBarostat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.SimulationFactory.addBarostat" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a MonteCarloBarostat to the MD system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>system</strong> (<em>openmm.System</em>) – The OpenMM System object corresponding to the reference system.</li>
<li><strong>temperature</strong> (<em>float, default=300</em>) – temperature (Kelvin) to be simulated at.</li>
<li><strong>pressure</strong> (<em>int, configional, default=None</em>) – Pressure (atm) for Barostat for NPT simulations.</li>
<li><strong>frequency</strong> (<em>int, default=25</em>) – Frequency at which Monte Carlo pressure changes should be attempted (in time steps)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>system</strong> (<em>openmm.System</em>) – The OpenMM System with the MonteCarloBarostat attached.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="blues.simulation.SimulationFactory.generateIntegrator">
<em class="property">classmethod </em><code class="descname">generateIntegrator</code><span class="sig-paren">(</span><em>temperature=Quantity(value=300</em>, <em>unit=kelvin)</em>, <em>dt=Quantity(value=0.002</em>, <em>unit=picosecond)</em>, <em>friction=1</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#SimulationFactory.generateIntegrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.SimulationFactory.generateIntegrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a LangevinIntegrator for the Simulations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>temperature</strong> (<em>float, default=300</em>) – temperature (Kelvin) to be simulated at.</li>
<li><strong>friction</strong> (<em>float, default=1</em>) – friction coefficient which couples to the heat bath, measured in 1/ps</li>
<li><strong>dt</strong> (<em>int, configional, default=0.002</em>) – The timestep of the integrator to use (in ps).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>integrator</strong> (<em>openmm.LangevinIntegrator</em>) – The LangevinIntegrator object intended for the System.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="blues.simulation.SimulationFactory.generateNCMCIntegrator">
<em class="property">classmethod </em><code class="descname">generateNCMCIntegrator</code><span class="sig-paren">(</span><em>nstepsNC=None</em>, <em>alchemical_functions={'lambda_electrostatics': 'step(0.2-lambda) - 1/0.2*lambda*step(0.2-lambda) + 1/0.2*(lambda-0.8)*step(lambda-0.8)'</em>, <em>'lambda_sterics': 'min(1</em>, <em>(1/0.3)*abs(lambda-0.5))'}</em>, <em>splitting='H V R O R V H'</em>, <em>temperature=Quantity(value=300</em>, <em>unit=kelvin)</em>, <em>dt=Quantity(value=0.002</em>, <em>unit=picosecond)</em>, <em>nprop=1</em>, <em>propLambda=0.3</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#SimulationFactory.generateNCMCIntegrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.SimulationFactory.generateNCMCIntegrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the AlchemicalExternalLangevinIntegrator using openmmtools.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nstepsNC</strong> (<em>int</em>) – The number of NCMC relaxation steps to use.</li>
<li><strong>alchemical_functions</strong> (<em>dict</em>) – default = <cite>{‘lambda_sterics’ : ‘min(1, (1/0.3)*abs(lambda-0.5))’, lambda_electrostatics’ : ‘step(0.2-lambda) - 1/0.2*lambda*step(0.2-lambda) + 1/0.2*(lambda-0.8)*step(lambda-0.8)’}</cite>
key : value pairs such as “global_parameter” : function_of_lambda where function_of_lambda is a Lepton-compatible string that depends on the variable “lambda”.</li>
<li><strong>splitting</strong> (<em>string, default: “H V R O R V H”</em>) – Sequence of R, V, O (and optionally V{i}), and { }substeps to be executed each timestep. There is also an H option, which increments the global parameter <cite>lambda</cite> by 1/nsteps_neq for each step. Forces are only used in V-step. Handle multiple force groups by appending the force group index to V-steps, e.g. “V0” will only use forces from force group 0. “V” will perform a step using all forces. ( will cause metropolization, and must be followed later by a ).</li>
<li><strong>temperature</strong> (<em>float, default=300</em>) – temperature (Kelvin) to be simulated at.</li>
<li><strong>dt</strong> (<em>int, optional, default=0.002</em>) – The timestep of the integrator to use (in ps).</li>
<li><strong>nprop</strong> (<em>int (Default: 1)</em>) – Controls the number of propagation steps to add in the lambda
region defined by <cite>propLambda</cite></li>
<li><strong>propLambda</strong> (<em>float, optional, default=0.3</em>) – The range which additional propogation steps are added,
defined by [0.5-propLambda, 0.5+propLambda].</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ncmc_integrator</strong> (<em>blues.integrator.AlchemicalExternalLangevinIntegrator</em>) – The NCMC integrator for the alchemical process in the NCMC simulation.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="blues.simulation.SimulationFactory.generateSimFromStruct">
<em class="property">classmethod </em><code class="descname">generateSimFromStruct</code><span class="sig-paren">(</span><em>structure</em>, <em>system</em>, <em>integrator</em>, <em>platform=None</em>, <em>properties={}</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#SimulationFactory.generateSimFromStruct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.SimulationFactory.generateSimFromStruct" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the OpenMM Simulation objects from a given parmed.Structure()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>structure</strong> (<em>parmed.Structure</em>) – ParmEd Structure object of the entire system to be simulated.</li>
<li><strong>system</strong> (<em>openmm.System</em>) – The OpenMM System object corresponding to the reference system.</li>
<li><strong>integrator</strong> (<em>openmm.Integrator</em>) – The OpenMM Integrator object for the simulation.</li>
<li><strong>platform</strong> (<em>str, default = None</em>) – Valid choices: ‘Auto’, ‘OpenCL’, ‘CUDA’
If None is specified, the fastest available platform will be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>simulation</strong> (<em>openmm.Simulation</em>) – The generated OpenMM Simulation from the parmed.Structure, openmm.System,
amd the integrator.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="blues.simulation.SimulationFactory.attachReporters">
<em class="property">static </em><code class="descname">attachReporters</code><span class="sig-paren">(</span><em>simulation</em>, <em>reporter_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#SimulationFactory.attachReporters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.SimulationFactory.attachReporters" title="Permalink to this definition">¶</a></dt>
<dd><p>Attach the list of reporters to the Simulation object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>simulation</strong> (<em>openmm.Simulation</em>) – The Simulation object to attach reporters to.</li>
<li><strong>reporter_list</strong> (<em>list of openmm Reporeters</em>) – The list of reporters to attach to the OpenMM Simulation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>simulation</strong> (<em>openmm.Simulation</em>) – The Simulation object with the reporters attached.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.simulation.SimulationFactory.generateSimulationSet">
<code class="descname">generateSimulationSet</code><span class="sig-paren">(</span><em>config=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#SimulationFactory.generateSimulationSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.SimulationFactory.generateSimulationSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the 3 OpenMM Simulation objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>config</strong> (<em>dict</em>) – Dictionary of parameters for configuring the OpenMM Simulations</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="bluessimulation">
<h3>BLUESSimulation<a class="headerlink" href="#bluessimulation" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="blues.simulation.BLUESSimulation">
<em class="property">class </em><code class="descclassname">blues.simulation.</code><code class="descname">BLUESSimulation</code><span class="sig-paren">(</span><em>simulations</em>, <em>config=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#BLUESSimulation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.BLUESSimulation" title="Permalink to this definition">¶</a></dt>
<dd><p>BLUESSimulation class provides methods to execute the NCMC+MD
simulation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>simulations</strong> (<em>blues.simulation.SimulationFactory object</em>) – SimulationFactory Object which carries the 3 required
OpenMM Simulation objects (MD, NCMC, ALCH) required to run BLUES.</li>
<li><strong>config</strong> (<em>dict</em>) – Dictionary of parameters for configuring the OpenMM Simulations
If None, will search for configuration parameters on the <cite>simulations</cite>
object.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Create our SimulationFactory object and run <cite>BLUESSimulation</cite></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim_cfg</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;platform&#39;</span><span class="p">:</span> <span class="s1">&#39;OpenCL&#39;</span><span class="p">,</span>
<span class="go">                &#39;properties&#39; : { &#39;OpenCLPrecision&#39;: &#39;single&#39;,</span>
<span class="go">                                 &#39;OpenCLDeviceIndex&#39; : 2},</span>
<span class="go">                &#39;nprop&#39; : 1,</span>
<span class="go">                &#39;propLambda&#39; : 0.3,</span>
<span class="go">                &#39;dt&#39; : 0.001 * unit.picoseconds,</span>
<span class="go">                &#39;friction&#39; : 1 * 1/unit.picoseconds,</span>
<span class="go">                &#39;temperature&#39; : 100 * unit.kelvin,</span>
<span class="go">                &#39;nIter&#39;: 1,</span>
<span class="go">                &#39;nstepsMD&#39;: 10,</span>
<span class="go">                &#39;nstepsNC&#39;: 10,}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simulations</span> <span class="o">=</span> <span class="n">SimulationFactory</span><span class="p">(</span><span class="n">systems</span><span class="p">,</span> <span class="n">ligand_mover</span><span class="p">,</span> <span class="n">sim_cfg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blues</span> <span class="o">=</span> <span class="n">BLUESSimulation</span><span class="p">(</span><span class="n">simulations</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blues</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<dl class="classmethod">
<dt id="blues.simulation.BLUESSimulation.getStateFromContext">
<em class="property">classmethod </em><code class="descname">getStateFromContext</code><span class="sig-paren">(</span><em>context</em>, <em>state_keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#BLUESSimulation.getStateFromContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.BLUESSimulation.getStateFromContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the State information from the given context and
list of state_keys to query it with.</p>
<p>Returns the state data as a dict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>context</strong> (<em>openmm.Context</em>) – Context of the OpenMM Simulation to query.</li>
<li><strong>state_keys</strong> (<em>list</em>) – Default: [ positions, velocities, potential_energy, kinetic_energy ]
A list that defines what information to get from the context State.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>stateinfo</strong> (<em>dict</em>) – Current positions, velocities, energies and box vectors of the context.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="blues.simulation.BLUESSimulation.getIntegratorInfo">
<em class="property">classmethod </em><code class="descname">getIntegratorInfo</code><span class="sig-paren">(</span><em>ncmc_integrator, integrator_keys=['lambda', 'shadow_work', 'protocol_work', 'Eold', 'Enew']</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#BLUESSimulation.getIntegratorInfo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.BLUESSimulation.getIntegratorInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict of alchemical/ncmc-swtiching data from querying the the NCMC
integrator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ncmc_integrator</strong> (<em>openmm.Context.Integrator</em>) – The integrator from the NCMC Context</li>
<li><strong>integrator_keys</strong> (<em>list</em>) – list containing strings of the values to get from the integrator.
Default = [‘lambda’, ‘shadow_work’, ‘protocol_work’, ‘Eold’, ‘Enew’,’Epert’]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>integrator_info</strong> (<em>dict</em>) – Work values and energies from the NCMC integrator.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="blues.simulation.BLUESSimulation.setContextFromState">
<em class="property">classmethod </em><code class="descname">setContextFromState</code><span class="sig-paren">(</span><em>context</em>, <em>state</em>, <em>box=True</em>, <em>positions=True</em>, <em>velocities=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#BLUESSimulation.setContextFromState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.BLUESSimulation.setContextFromState" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given Context from the given State.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>context</strong> (<em>openmm.Context</em>) – The Context to be updated from the given State.</li>
<li><strong>state</strong> (<em>openmm.State</em>) – The current state (box_vectors, positions, velocities) of the
Simulation to update the given context.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>context</strong> (<em>openmm.Context</em>) – The updated Context whose box_vectors, positions, and velocities
have been updated.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.simulation.BLUESSimulation._printSimulationTiming">
<code class="descname">_printSimulationTiming</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#BLUESSimulation._printSimulationTiming"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.BLUESSimulation._printSimulationTiming" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the simulation timing and related information.</p>
</dd></dl>

<dl class="method">
<dt id="blues.simulation.BLUESSimulation._setStateTable">
<code class="descname">_setStateTable</code><span class="sig-paren">(</span><em>simkey</em>, <em>stateidx</em>, <em>stateinfo</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#BLUESSimulation._setStateTable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.BLUESSimulation._setStateTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates <cite>stateTable</cite> (dict) containing:  Positions, Velocities, Potential/Kinetic energies
of the state before and after a NCMC step or iteration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>simkey</strong> (<em>str (key: ‘md’, ‘ncmc’, ‘alch’)</em>) – Key corresponding to the simulation.</li>
<li><strong>stateidx</strong> (<em>str (key: ‘state0’ or ‘state1’)</em>) – Key corresponding to the state information being stored.</li>
<li><strong>stateinfo</strong> (<em>dict</em>) – Dictionary containing the State information.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.simulation.BLUESSimulation._syncStatesMDtoNCMC">
<code class="descname">_syncStatesMDtoNCMC</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#BLUESSimulation._syncStatesMDtoNCMC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.BLUESSimulation._syncStatesMDtoNCMC" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves data on the current State of the MD context to
replace the box vectors, positions, and velocties in the NCMC context.</p>
</dd></dl>

<dl class="method">
<dt id="blues.simulation.BLUESSimulation._stepNCMC">
<code class="descname">_stepNCMC</code><span class="sig-paren">(</span><em>nstepsNC</em>, <em>moveStep</em>, <em>move_engine=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#BLUESSimulation._stepNCMC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.BLUESSimulation._stepNCMC" title="Permalink to this definition">¶</a></dt>
<dd><p>Advance the NCMC simulation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nstepsNC</strong> (<em>int</em>) – The number of NCMC switching steps to advance by.</li>
<li><strong>moveStep</strong> (<em>int</em>) – The step number to perform the chosen move, which should be half
the number of nstepsNC.</li>
<li><strong>move_engine</strong> (<em>blues.moves.MoveEngine</em>) – The object that executes the chosen move.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.simulation.BLUESSimulation._computeAlchemicalCorrection">
<code class="descname">_computeAlchemicalCorrection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#BLUESSimulation._computeAlchemicalCorrection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.BLUESSimulation._computeAlchemicalCorrection" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the alchemical correction term from switching between the NCMC
and MD potentials.</p>
</dd></dl>

<dl class="method">
<dt id="blues.simulation.BLUESSimulation._acceptRejectMove">
<code class="descname">_acceptRejectMove</code><span class="sig-paren">(</span><em>write_move=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#BLUESSimulation._acceptRejectMove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.BLUESSimulation._acceptRejectMove" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose to accept or reject the proposed move based
on the acceptance criterion.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>write_move</strong> (<em>bool, default=False</em>) – If True, writes the proposed NCMC move to a PDB file.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.simulation.BLUESSimulation._resetSimulations">
<code class="descname">_resetSimulations</code><span class="sig-paren">(</span><em>temperature=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#BLUESSimulation._resetSimulations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.BLUESSimulation._resetSimulations" title="Permalink to this definition">¶</a></dt>
<dd><p>At the end of each iteration:</p>
<ol class="arabic simple">
<li>Reset the step number in the NCMC context/integrator</li>
<li>Set the velocities to random values chosen from a Boltzmann distribution at a given <cite>temperature</cite>.</li>
</ol>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>temperature</strong> (<em>float</em>) – The target temperature for the simulation.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.simulation.BLUESSimulation._stepMD">
<code class="descname">_stepMD</code><span class="sig-paren">(</span><em>nstepsMD</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#BLUESSimulation._stepMD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.BLUESSimulation._stepMD" title="Permalink to this definition">¶</a></dt>
<dd><p>Advance the MD simulation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nstepsMD</strong> (<em>int</em>) – The number of steps to advance the MD simulation.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.simulation.BLUESSimulation.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>nIter=0</em>, <em>nstepsNC=0</em>, <em>moveStep=0</em>, <em>nstepsMD=0</em>, <em>temperature=300</em>, <em>write_move=False</em>, <em>**config</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/simulation.html#BLUESSimulation.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.simulation.BLUESSimulation.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes the BLUES engine to iterate over the actions:
Perform NCMC simulation, perform proposed move, accepts/rejects move,
then performs the MD simulation from the NCMC state, niter number of times.
<strong>Note:</strong> If the parameters are not given explicitly, will look for the parameters
in the provided configuration on the <cite>SimulationFactory</cite> object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nIter</strong> (<em>int, default = None</em>) – Number of iterations of NCMC+MD to perform.</li>
<li><strong>nstepsNC</strong> (<em>int</em>) – The number of NCMC switching steps to advance by.</li>
<li><strong>moveStep</strong> (<em>int</em>) – The step number to perform the chosen move, which should be half
the number of nstepsNC.</li>
<li><strong>nstepsMD</strong> (<em>int</em>) – The number of steps to advance the MD simulation.</li>
<li><strong>temperature</strong> (<em>float</em>) – The target temperature for the simulation.</li>
<li><strong>write_move</strong> (<em>bool, default=False</em>) – If True, writes the proposed NCMC move to a PDB file.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-blues.integrators">
<span id="integrators"></span><h2>Integrators<a class="headerlink" href="#module-blues.integrators" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="blues.integrators.AlchemicalExternalLangevinIntegrator">
<em class="property">class </em><code class="descclassname">blues.integrators.</code><code class="descname">AlchemicalExternalLangevinIntegrator</code><span class="sig-paren">(</span><em>alchemical_functions</em>, <em>splitting='R V O H O V R'</em>, <em>temperature=Quantity(value=298.0</em>, <em>unit=kelvin)</em>, <em>collision_rate=Quantity(value=1.0</em>, <em>unit=/picosecond)</em>, <em>timestep=Quantity(value=1.0</em>, <em>unit=femtosecond)</em>, <em>constraint_tolerance=1e-08</em>, <em>measure_shadow_work=False</em>, <em>measure_heat=True</em>, <em>nsteps_neq=100</em>, <em>nprop=1</em>, <em>prop_lambda=0.3</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/integrators.html#AlchemicalExternalLangevinIntegrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.integrators.AlchemicalExternalLangevinIntegrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows nonequilibrium switching based on force parameters specified in alchemical_functions.
A variable named lambda is switched from 0 to 1 linearly throughout the nsteps of the protocol.
The functions can use this to create more complex protocols for other global parameters.</p>
<p>As opposed to <cite>openmmtools.integrators.AlchemicalNonequilibriumLangevinIntegrator</cite>,
which this inherits from, the AlchemicalExternalLangevinIntegrator integrator also takes
into account work done outside the nonequilibrium switching portion(between integration steps).
For example if a molecule is rotated between integration steps, this integrator would
correctly account for the work caused by that rotation.</p>
<p>Propagator is based on Langevin splitting, as described below.
One way to divide the Langevin system is into three parts which can each be solved “exactly:”</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>R: Linear “drift” / Constrained “drift”</dt>
<dd>Deterministic update of <em>positions</em>, using current velocities
<code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">&lt;-</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">v</span> <span class="pre">dt</span></code></dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>V: Linear “kick” / Constrained “kick”</dt>
<dd>Deterministic update of <em>velocities</em>, using current forces
<code class="docutils literal notranslate"><span class="pre">v</span> <span class="pre">&lt;-</span> <span class="pre">v</span> <span class="pre">+</span> <span class="pre">(f/m)</span> <span class="pre">dt</span></code>; where f = force, m = mass</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>O: Ornstein-Uhlenbeck</dt>
<dd>Stochastic update of velocities, simulating interaction with a heat bath
<code class="docutils literal notranslate"><span class="pre">v</span> <span class="pre">&lt;-</span> <span class="pre">av</span> <span class="pre">+</span> <span class="pre">b</span> <span class="pre">sqrt(kT/m)</span> <span class="pre">R</span></code> where:<ul class="last">
<li>a = e^(-gamma dt)</li>
<li>b = sqrt(1 - e^(-2gamma dt))</li>
<li>R is i.i.d. standard normal</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>We can then construct integrators by solving each part for a certain timestep in sequence.
(We can further split up the V step by force group, evaluating cheap but fast-fluctuating
forces more frequently than expensive but slow-fluctuating forces. Since forces are only
evaluated in the V step, we represent this by including in our “alphabet” V0, V1, …)
When the system contains holonomic constraints, these steps are confined to the constraint
manifold.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>alchemical_functions</strong> (<em>dict of strings</em>) – key: value pairs such as “global_parameter” : function_of_lambda where function_of_lambda is a Lepton-compatible string that depends on the variable “lambda”</li>
<li><strong>splitting</strong> (<em>string, default: “H V R O V R H”</em>) – Sequence of R, V, O (and optionally V{i}), and { }substeps to be executed each timestep. There is also an H option, which increments the global parameter <cite>lambda</cite> by 1/nsteps_neq for each step.
Forces are only used in V-step. Handle multiple force groups by appending the force group index
to V-steps, e.g. “V0” will only use forces from force group 0. “V” will perform a step using all forces.( will cause metropolization, and must be followed later by a ).</li>
<li><strong>temperature</strong> (<em>numpy.unit.Quantity compatible with kelvin, default: 298.0*simtk.unit.kelvin</em>) – Fictitious “bath” temperature</li>
<li><strong>collision_rate</strong> (<em>numpy.unit.Quantity compatible with 1/picoseconds, default: 91.0/simtk.unit.picoseconds</em>) – Collision rate</li>
<li><strong>timestep</strong> (<em>numpy.unit.Quantity compatible with femtoseconds, default: 1.0*simtk.unit.femtoseconds</em>) – Integration timestep</li>
<li><strong>constraint_tolerance</strong> (<em>float, default: 1.0e-8</em>) – Tolerance for constraint solver</li>
<li><strong>measure_shadow_work</strong> (<em>boolean, default: False</em>) – Accumulate the shadow work performed by the symplectic substeps, in the global <cite>shadow_work</cite></li>
<li><strong>measure_heat</strong> (<em>boolean, default: True</em>) – Accumulate the heat exchanged with the bath in each step, in the global <cite>heat</cite></li>
<li><strong>nsteps_neq</strong> (<em>int, default: 100</em>) – Number of steps in nonequilibrium protocol. Default 100</li>
<li><strong>prop_lambda</strong> (<em>float (Default = 0.3)</em>) – Defines the region in which to add extra propagation
steps during the NCMC simulation from the midpoint 0.5.
i.e. A value of 0.3 will add extra steps from lambda 0.2 to 0.8.</li>
<li><strong>nprop</strong> (<em>int (Default: 1)</em>) – Controls the number of propagation steps to add in the lambda
region defined by <cite>prop_lambda</cite>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="blues.integrators.AlchemicalExternalLangevinIntegrator._kinetic_energy">
<code class="descname">_kinetic_energy</code><a class="headerlink" href="#blues.integrators.AlchemicalExternalLangevinIntegrator._kinetic_energy" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – This is 0.5*m*v*v by default, and is the expression used for the kinetic energy</p>
</dd></dl>

<p class="rubric">Examples</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>g-BAOAB:</dt>
<dd>splitting=”R V O H O V R”</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>VVVR</dt>
<dd>splitting=”O V R H R V O”</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>VV</dt>
<dd>splitting=”V R H R V”</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>An NCMC algorithm with Metropolized integrator:</dt>
<dd>splitting=”O { V R H R V } O”</dd>
</dl>
</li>
</ul>
<p class="rubric">References</p>
<p>[Nilmeier, et al. 2011] Nonequilibrium candidate Monte Carlo is an efficient tool for equilibrium simulation</p>
<p>[Leimkuhler and Matthews, 2015] Molecular dynamics: with deterministic and stochastic numerical methods, Chapter 7</p>
<dl class="method">
<dt id="blues.integrators.AlchemicalExternalLangevinIntegrator.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/integrators.html#AlchemicalExternalLangevinIntegrator.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.integrators.AlchemicalExternalLangevinIntegrator.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Manually reset protocol work and other statistics.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-blues.utils">
<span id="utilities"></span><h2>Utilities<a class="headerlink" href="#module-blues.utils" title="Permalink to this headline">¶</a></h2>
<p>Provides a host of utility functions for the BLUES engine.</p>
<p>Authors: Samuel C. Gill
Contributors: Nathan M. Lim, David L. Mobley</p>
<dl class="function">
<dt id="blues.utils.saveSimulationFrame">
<code class="descclassname">blues.utils.</code><code class="descname">saveSimulationFrame</code><span class="sig-paren">(</span><em>simulation</em>, <em>outfname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/utils.html#saveSimulationFrame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.utils.saveSimulationFrame" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts a ParmEd structure and writes the frame given
an OpenMM Simulation object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>simulation</strong> (<em>openmm.Simulation</em>) – The OpenMM Simulation to write a frame from.</li>
<li><strong>outfname</strong> (<em>str</em>) – The output file name to save the simulation frame from. Supported
extensions:<ul>
<li>PDB (.pdb, pdb)</li>
<li>PDBx/mmCIF (.cif, cif)</li>
<li>PQR (.pqr, pqr)</li>
<li>Amber topology file (.prmtop/.parm7, amber)</li>
<li>CHARMM PSF file (.psf, psf)</li>
<li>CHARMM coordinate file (.crd, charmmcrd)</li>
<li>Gromacs topology file (.top, gromacs)</li>
<li>Gromacs GRO file (.gro, gro)</li>
<li>Mol2 file (.mol2, mol2)</li>
<li>Mol3 file (.mol3, mol3)</li>
<li>Amber ASCII restart (.rst7/.inpcrd/.restrt, rst7)</li>
<li>Amber NetCDF restart (.ncrst, ncrst)</li>
</ul>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="blues.utils.print_host_info">
<code class="descclassname">blues.utils.</code><code class="descname">print_host_info</code><span class="sig-paren">(</span><em>simulation</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/utils.html#print_host_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.utils.print_host_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints hardware related information for the openmm.Simulation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>simulation</strong> (<em>openmm.Simulation</em>) – The OpenMM Simulation to write a frame from.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="blues.utils.calculateNCMCSteps">
<code class="descclassname">blues.utils.</code><code class="descname">calculateNCMCSteps</code><span class="sig-paren">(</span><em>nstepsNC=0</em>, <em>nprop=1</em>, <em>propLambda=0.3</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/utils.html#calculateNCMCSteps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.utils.calculateNCMCSteps" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the number of NCMC switching steps.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nstepsNC</strong> (<em>int</em>) – The number of NCMC switching steps</li>
<li><strong>nprop</strong> (<em>int, default=1</em>) – The number of propagation steps per NCMC switching steps</li>
<li><strong>propLambda</strong> (<em>float, default=0.3</em>) – The lambda values in which additional propagation steps will be added
or 0.5 +/- propLambda. If 0.3, this will add propgation steps at lambda
values 0.2 to 0.8.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="blues.utils.check_amber_selection">
<code class="descclassname">blues.utils.</code><code class="descname">check_amber_selection</code><span class="sig-paren">(</span><em>structure</em>, <em>selection</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/utils.html#check_amber_selection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.utils.check_amber_selection" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a AmberMask selection (str) for selecting atoms to freeze or restrain,
check if it will actually select atoms. If the selection produces None,
suggest valid residues or atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>structure</strong> (<em>parmed.Structure</em>) – The structure of the simulated system</li>
<li><strong>selection</strong> (<em>str</em>) – The selection string uses Amber selection syntax to select atoms to be
restrained/frozen during simulation.</li>
<li><strong>logger</strong> (<em>logging.Logger</em>) – Records information or streams to terminal.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="blues.utils.parse_unit_quantity">
<code class="descclassname">blues.utils.</code><code class="descname">parse_unit_quantity</code><span class="sig-paren">(</span><em>unit_quantity_str</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/utils.html#parse_unit_quantity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.utils.parse_unit_quantity" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility for parsing parameters from the YAML file that require units.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>unit_quantity_str</strong> (<em>str</em>) – A string specifying a quantity and it’s units. i.e. ‘3.024 * daltons’</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>unit_quantity</strong> (<em>simtk.unit.Quantity</em>) – i.e <cite>unit.Quantity(3.024, unit=dalton)</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="blues.utils.zero_masses">
<code class="descclassname">blues.utils.</code><code class="descname">zero_masses</code><span class="sig-paren">(</span><em>system</em>, <em>atomList=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/utils.html#zero_masses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.utils.zero_masses" title="Permalink to this definition">¶</a></dt>
<dd><p>Zeroes the masses of specified atoms to constrain certain degrees of freedom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>system</strong> (<em>penmm.System</em>) – system to zero masses</li>
<li><strong>atomList</strong> (<em>list of ints</em>) – atom indicies to zero masses</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>system</strong> (<em>openmm.System</em>) – The modified system with massless atoms.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="blues.utils.atomIndexfromTop">
<code class="descclassname">blues.utils.</code><code class="descname">atomIndexfromTop</code><span class="sig-paren">(</span><em>resname</em>, <em>topology</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/utils.html#atomIndexfromTop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.utils.atomIndexfromTop" title="Permalink to this definition">¶</a></dt>
<dd><p>Get atom indices of a ligand from OpenMM Topology.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>resname</strong> (<em>str</em>) – resname that you want to get the atom indicies for (ex. ‘LIG’)</li>
<li><strong>topology</strong> (<em>str, optional, default=None</em>) – path of topology file. Include if the topology is not included
in the coord_file</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>lig_atoms</strong> (<em>list of ints</em>) – list of atoms in the coordinate file matching lig_resname</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="blues.utils.get_data_filename">
<code class="descclassname">blues.utils.</code><code class="descname">get_data_filename</code><span class="sig-paren">(</span><em>package_root</em>, <em>relative_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/utils.html#get_data_filename"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.utils.get_data_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the full path to one of the reference files in testsystems.
In the source distribution, these files are in <code class="docutils literal notranslate"><span class="pre">blues/data/</span></code>,
but on installation, they’re moved to somewhere in the user’s python
site-packages directory.
Adapted from:
<a class="reference external" href="https://github.com/open-forcefield-group/smarty/blob/master/smarty/utils.py">https://github.com/open-forcefield-group/smarty/blob/master/smarty/utils.py</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>package_root</strong> (<em>str</em>) – Name of the included/installed python package</li>
<li><strong>relative_path</strong> (<em>str</em>) – Path to the file within the python package</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>fn</strong> (<em>str</em>) – Full path to file</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="blues.utils.spreadLambdaProtocol">
<code class="descclassname">blues.utils.</code><code class="descname">spreadLambdaProtocol</code><span class="sig-paren">(</span><em>switching_values</em>, <em>steps</em>, <em>switching_types='auto'</em>, <em>kind='cubic'</em>, <em>return_tab_function=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/utils.html#spreadLambdaProtocol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.utils.spreadLambdaProtocol" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of lambda values (either for sterics or electrostatics) and transforms that list
to be spread out over a given <cite>steps</cite> range to be easily compatible with the OpenMM Discrete1DFunction
tabulated function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>switching_values</strong> (<em>list</em>) – A list of lambda values decreasing from 1 to 0.</li>
<li><strong>steps</strong> (<em>int</em>) – The number of steps wanted for the tabulated function.</li>
<li><strong>switching_types</strong> (<em>str, optional, default=’auto’</em>) – The type of lambda switching the <cite>switching_values</cite> corresponds to, either ‘auto’, ‘electrostatics’,
or ‘sterics’. If ‘electrostatics’ this assumes the inital value immediately decreases from 1.
If ‘sterics’ this assumes the inital values stay at 1 for some period.
If ‘auto’ this function tries to guess the switching_types based on this, based on typical
lambda protocols turning off the electrostatics completely, before turning off sterics.</li>
<li><strong>kind</strong> (<em>str, optional, default=’cubic’</em>) – The kind of interpolation that should be performed (using scipy.interpolate.interp1d) to
define the lines between the points of switching_values.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>tab_steps</strong> (<em>list or simtk.openmm.openmm.Discrete1DFunction</em>) – List of length <cite>steps</cite> that corresponds to the tabulated-friendly version of the input switching_values.
If return-tab_function=True</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">simtk.openmm.openmm</span> <span class="k">import</span> <span class="n">Continuous1DFunction</span><span class="p">,</span> <span class="n">Discrete1DFunction</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sterics</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.8848447462380346</span><span class="p">,</span>
<span class="go">                0.8428373352131427, 0.7928373352131427, 0.7490146003095886, 0.6934088361682191,</span>
<span class="go">                0.6515123083157823, 0.6088924298371354, 0.5588924298371354, 0.5088924298371353,</span>
<span class="go">                0.4649556683144045, 0.4298606804827029, 0.3798606804827029, 0.35019373288005945,</span>
<span class="go">                0.31648339779024653, 0.2780498882483276, 0.2521302239477468, 0.23139484523965026,</span>
<span class="go">                0.18729812232625365, 0.15427643961733822, 0.12153116162972155,</span>
<span class="go">                0.09632462702545555, 0.06463743549588846, 0.01463743549588846,</span>
<span class="go">                0.0]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">statics</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.8519493439593149</span><span class="p">,</span> <span class="mf">0.7142750443470669</span><span class="p">,</span>
<span class="go">                0.5385929179832776, 0.3891972949356391, 0.18820309596839535, 0.0,</span>
<span class="go">                0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,</span>
<span class="go">                0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">statics_tab</span> <span class="o">=</span> <span class="n">spreadLambdaProtocol</span><span class="p">(</span><span class="n">statics</span><span class="p">,</span> <span class="n">opt</span><span class="p">[</span><span class="s1">&#39;nstepsNC&#39;</span><span class="p">],</span> <span class="n">switching_types</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sterics_tab</span> <span class="o">=</span> <span class="n">spreadLambdaProtocol</span><span class="p">(</span><span class="n">sterics</span><span class="p">,</span> <span class="n">opt</span><span class="p">[</span><span class="s1">&#39;nstepsNC&#39;</span><span class="p">],</span> <span class="n">switching_types</span><span class="o">=</span><span class="s1">&#39;sterics&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming some Context already exists:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">_integrator</span><span class="o">.</span><span class="n">addTabulatedFunction</span><span class="p">(</span> <span class="s1">&#39;sterics_tab&#39;</span><span class="p">,</span> <span class="n">sterics_tab</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">_integrator</span><span class="o">.</span><span class="n">addTabulatedFunction</span><span class="p">(</span> <span class="s1">&#39;electrostatics_tab&#39;</span><span class="p">,</span> <span class="n">statics_tab</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-blues.reporters">
<span id="reporters"></span><h2>Reporters<a class="headerlink" href="#module-blues.reporters" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="blues.reporters.addLoggingLevel">
<code class="descclassname">blues.reporters.</code><code class="descname">addLoggingLevel</code><span class="sig-paren">(</span><em>levelName</em>, <em>levelNum</em>, <em>methodName=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/reporters.html#addLoggingLevel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.reporters.addLoggingLevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Comprehensively adds a new logging level to the <cite>logging</cite> module and the
currently configured logging class.</p>
<p><cite>levelName</cite> becomes an attribute of the <cite>logging</cite> module with the value
<cite>levelNum</cite>. <cite>methodName</cite> becomes a convenience method for both <cite>logging</cite>
itself and the class returned by <cite>logging.getLoggerClass()</cite> (usually just
<cite>logging.Logger</cite>). If <cite>methodName</cite> is not specified, <cite>levelName.lower()</cite> is
used.</p>
<p>To avoid accidental clobberings of existing attributes, this method will
raise an <cite>AttributeError</cite> if the level name is already an attribute of the
<cite>logging</cite> module or if the method name is already present</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>levelName</strong> (<em>str</em>) – The new level name to be added to the <cite>logging</cite> module.</li>
<li><strong>levelNum</strong> (<em>int</em>) – The level number indicated for the logging module.</li>
<li><strong>methodName</strong> (<em>str, default=None</em>) – The method to call on the logging module for the new level name.
For example if provided ‘trace’, you would call <cite>logging.trace()</cite>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">addLoggingLevel</span><span class="p">(</span><span class="s1">&#39;TRACE&#39;</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="s2">&quot;TRACE&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s1">&#39;that worked&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logging</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s1">&#39;so did this&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logging</span><span class="o">.</span><span class="n">TRACE</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="blues.reporters.init_logger">
<code class="descclassname">blues.reporters.</code><code class="descname">init_logger</code><span class="sig-paren">(</span><em>logger</em>, <em>level=20</em>, <em>stream=True</em>, <em>outfname='blues-20180830-153931'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/reporters.html#init_logger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.reporters.init_logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the Logger module with the given logger_level and outfname.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>logger</strong> (<em>logging.getLogger()</em>) – The root logger object if it has been created already.</li>
<li><strong>level</strong> (<em>logging.&lt;LEVEL&gt;</em>) – Valid options for &lt;LEVEL&gt; would be DEBUG, INFO, WARNING, ERROR, CRITICAL.</li>
<li><strong>stream</strong> (<em>bool, default = True</em>) – If True, the logger will also stream information to sys.stdout as well
as the output file.</li>
<li><strong>outfname</strong> (<em>str, default = time.strftime(“blues-%Y%m%d-%H%M%S”)</em>) – The output file path prefix to store the logged data. This will always
write to a file with the extension <cite>.log</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>logger</strong> (<em>logging.getLogger()</em>) – The logging object with additional Handlers added.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="blues.reporters.ReporterConfig">
<em class="property">class </em><code class="descclassname">blues.reporters.</code><code class="descname">ReporterConfig</code><span class="sig-paren">(</span><em>outfname</em>, <em>reporter_config</em>, <em>logger=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/reporters.html#ReporterConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.reporters.ReporterConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a set of custom/recommended reporters for
BLUES simulations from YAML configuration. It can also be called
externally without a YAML configuration file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>outfname</strong> (<em>str,</em>) – Output filename prefix for files generated by the reporters.</li>
<li><strong>reporter_config</strong> (<em>dict</em>) – Dict of parameters for the md_reporters or ncmc_reporters.
Valid keys for reporters are: <cite>state</cite>, <cite>traj_netcdf</cite>, <cite>restart</cite>,
<cite>progress</cite>, and <cite>stream</cite>. All reporters except <cite>stream</cite>
are extensions of the parmed.openmm.reporters. More below:
- <cite>state</cite> : State data reporter for OpenMM simulations, but it is a little more generalized.    Writes to a <code class="docutils literal notranslate"><span class="pre">.ene</span></code> file. For full list of parameters see <cite>parmed.openmm.reporters.StateDataReporter</cite>.
- <cite>traj_netcdf</cite> : Customized AMBER NetCDF (<code class="docutils literal notranslate"><span class="pre">.nc</span></code>) format reporter
- <cite>restart</cite> : Restart AMBER NetCDF (<code class="docutils literal notranslate"><span class="pre">.rst7</span></code>) format reporter
- <cite>progress</cite> : Write to a file (<code class="docutils literal notranslate"><span class="pre">.prog</span></code>), the progress report of how many steps has been done, how fast the simulation is running, and how much time is left (similar to the mdinfo file in Amber). File is overwritten at each reportInterval. For full list of parameters see <cite>parmed.openmm.reporters.ProgressReporter</cite>
- <cite>stream</cite> : Customized version of openmm.app.StateDataReporter.This
will instead stream/print the information to the terminal as opposed to
writing to a file. Takes the same parameters as the openmm.app.StateDataReporter</li>
<li><strong>logger</strong> (<em>logging.Logger object</em>) – Provide the root logger for printing information.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>This class is intended to be called internally from <cite>blues.config.set_Reporters</cite>.
Below is an example to call this externally.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">blues.reporters</span> <span class="k">import</span> <span class="n">ReporterConfig</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">logging</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md_reporters</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;restart&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;reportInterval&quot;</span><span class="p">:</span> <span class="mi">1000</span> <span class="p">},</span>
<span class="go">                     &quot;state&quot; : { &quot;reportInterval&quot;: 250  },</span>
<span class="go">                     &quot;stream&quot;: { &quot;progress&quot;: true,</span>
<span class="go">                                 &quot;remainingTime&quot;: true,</span>
<span class="go">                                 &quot;reportInterval&quot;: 250,</span>
<span class="go">                                 &quot;speed&quot;: true,</span>
<span class="go">                                 &quot;step&quot;: true,</span>
<span class="go">                                 &quot;title&quot;: &quot;md&quot;,</span>
<span class="go">                                 &quot;totalSteps&quot;: 10000},</span>
<span class="go">                     &quot;traj_netcdf&quot;: { &quot;reportInterval&quot;: 250 }</span>
<span class="go">                    }</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md_reporter_cfg</span> <span class="o">=</span> <span class="n">ReporterConfig</span><span class="p">(</span><span class="n">outfname</span><span class="o">=</span><span class="s1">&#39;blues-test&#39;</span><span class="p">,</span> <span class="n">md_reporters</span><span class="p">,</span> <span class="n">logger</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md_reporters_list</span> <span class="o">=</span> <span class="n">md_reporter_cfg</span><span class="o">.</span><span class="n">makeReporters</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="blues.reporters.ReporterConfig.makeReporters">
<code class="descname">makeReporters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/reporters.html#ReporterConfig.makeReporters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.reporters.ReporterConfig.makeReporters" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of openmm Reporters based on the configuration at
initialization of the class.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="blues.reporters.BLUESHDF5Reporter">
<em class="property">class </em><code class="descclassname">blues.reporters.</code><code class="descname">BLUESHDF5Reporter</code><span class="sig-paren">(</span><em>file</em>, <em>reportInterval=1</em>, <em>title='NCMC Trajectory'</em>, <em>coordinates=True</em>, <em>frame_indices=[]</em>, <em>time=False</em>, <em>cell=True</em>, <em>temperature=False</em>, <em>potentialEnergy=False</em>, <em>kineticEnergy=False</em>, <em>velocities=False</em>, <em>atomSubset=None</em>, <em>protocolWork=True</em>, <em>alchemicalLambda=True</em>, <em>parameters=None</em>, <em>environment=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/reporters.html#BLUESHDF5Reporter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.reporters.BLUESHDF5Reporter" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a subclass of the HDF5 class from mdtraj that handles
reporting of the trajectory.</p>
<p>HDF5Reporter stores a molecular dynamics trajectory in the HDF5 format.
This object supports saving all kinds of information from the simulation –
more than any other trajectory format. In addition to all of the options,
the topology of the system will also (of course) be stored in the file. All
of the information is compressed, so the size of the file is not much
different than DCD, despite the added flexibility.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>file</strong> (<em>str, or HDF5TrajectoryFile</em>) – Either an open HDF5TrajecoryFile object to write to, or a string
specifying the filename of a new HDF5 file to save the trajectory to.</li>
<li><strong>title</strong> (<em>str,</em>) – String to specify the title of the HDF5 tables</li>
<li><strong>frame_indices</strong> (<em>list, frame numbers for writing the trajectory</em>)</li>
<li><strong>reportInterval</strong> (<em>int</em>) – The interval (in time steps) at which to write frames.</li>
<li><strong>coordinates</strong> (<em>bool</em>) – Whether to write the coordinates to the file.</li>
<li><strong>time</strong> (<em>bool</em>) – Whether to write the current time to the file.</li>
<li><strong>cell</strong> (<em>bool</em>) – Whether to write the current unit cell dimensions to the file.</li>
<li><strong>potentialEnergy</strong> (<em>bool</em>) – Whether to write the potential energy to the file.</li>
<li><strong>kineticEnergy</strong> (<em>bool</em>) – Whether to write the kinetic energy to the file.</li>
<li><strong>temperature</strong> (<em>bool</em>) – Whether to write the instantaneous temperature to the file.</li>
<li><strong>velocities</strong> (<em>bool</em>) – Whether to write the velocities to the file.</li>
<li><strong>atomSubset</strong> (<em>array_like, default=None</em>) – Only write a subset of the atoms, with these (zero based) indices
to the file. If None, <em>all</em> of the atoms will be written to disk.</li>
<li><strong>protocolWork</strong> (<em>bool=False,</em>) – Write the protocolWork for the alchemical process in the NCMC simulation</li>
<li><strong>alchemicalLambda</strong> (<em>bool=False,</em>) – Write the alchemicalLambda step for the alchemical process in the NCMC simulation.</li>
<li><strong>parameters</strong> (<em>dict</em>) – Dict of the simulation parameters. Useful for record keeping.</li>
<li><strong>environment</strong> (<em>bool</em>) – True will attempt to export your conda environment to JSON and
store the information in the HDF5 file. Useful for record keeping.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If you use the <code class="docutils literal notranslate"><span class="pre">atomSubset</span></code> option to write only a subset of the atoms
to disk, the <code class="docutils literal notranslate"><span class="pre">kineticEnergy</span></code>, <code class="docutils literal notranslate"><span class="pre">potentialEnergy</span></code>, and <code class="docutils literal notranslate"><span class="pre">temperature</span></code>
fields will not change. They will still refer to the energy and temperature
of the <em>whole</em> system, and are not “subsetted” to only include the energy
of your subsystem.</p>
<dl class="method">
<dt id="blues.reporters.BLUESHDF5Reporter.describeNextReport">
<code class="descname">describeNextReport</code><span class="sig-paren">(</span><em>simulation</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/reporters.html#BLUESHDF5Reporter.describeNextReport"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.reporters.BLUESHDF5Reporter.describeNextReport" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information about the next report this object will generate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>simulation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">app.Simulation</span></code>) – The simulation to generate a report for</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>nsteps, pos, vel, frc, ene</strong> (<em>int, bool, bool, bool, bool</em>) – nsteps is the number of steps until the next report
pos, vel, frc, and ene are flags indicating whether positions,
velocities, forces, and/or energies are needed from the Context</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.reporters.BLUESHDF5Reporter.report">
<code class="descname">report</code><span class="sig-paren">(</span><em>simulation</em>, <em>state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/reporters.html#BLUESHDF5Reporter.report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.reporters.BLUESHDF5Reporter.report" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a report.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>simulation</strong> (<em>simtk.openmm.app.Simulation</em>) – The Simulation to generate a report for</li>
<li><strong>state</strong> (<em>simtk.openmm.State</em>) – The current state of the simulation</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="blues.reporters.BLUESStateDataReporter">
<em class="property">class </em><code class="descclassname">blues.reporters.</code><code class="descname">BLUESStateDataReporter</code><span class="sig-paren">(</span><em>file</em>, <em>reportInterval=1</em>, <em>frame_indices=[]</em>, <em>title=''</em>, <em>step=False</em>, <em>time=False</em>, <em>potentialEnergy=False</em>, <em>kineticEnergy=False</em>, <em>totalEnergy=False</em>, <em>temperature=False</em>, <em>volume=False</em>, <em>density=False</em>, <em>progress=False</em>, <em>remainingTime=False</em>, <em>speed=False</em>, <em>elapsedTime=False</em>, <em>separator='t'</em>, <em>systemMass=None</em>, <em>totalSteps=None</em>, <em>protocolWork=False</em>, <em>alchemicalLambda=False</em>, <em>currentIter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/reporters.html#BLUESStateDataReporter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.reporters.BLUESStateDataReporter" title="Permalink to this definition">¶</a></dt>
<dd><p>StateDataReporter outputs information about a simulation, such as energy and temperature, to a file. To use it, create a StateDataReporter, then add it to the Simulation’s list of reporters.  The set of data to write is configurable using boolean flags passed to the constructor.  By default the data is written in comma-separated-value (CSV) format, but you can specify a different separator to use. Inherited from <cite>openmm.app.StateDataReporter</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>file</strong> (<em>string or file</em>) – The file to write to, specified as a file name or file-like object (Logger)</li>
<li><strong>reportInterval</strong> (<em>int</em>) – The interval (in time steps) at which to write frames</li>
<li><strong>frame_indices</strong> (<em>list, frame numbers for writing the trajectory</em>)</li>
<li><strong>title</strong> (<em>str,</em>) – Text prefix for each line of the report. Used to distinguish
between the NCMC and MD simulation reports.</li>
<li><strong>step</strong> (<em>bool=False</em>) – Whether to write the current step index to the file</li>
<li><strong>time</strong> (<em>bool=False</em>) – Whether to write the current time to the file</li>
<li><strong>potentialEnergy</strong> (<em>bool=False</em>) – Whether to write the potential energy to the file</li>
<li><strong>kineticEnergy</strong> (<em>bool=False</em>) – Whether to write the kinetic energy to the file</li>
<li><strong>totalEnergy</strong> (<em>bool=False</em>) – Whether to write the total energy to the file</li>
<li><strong>temperature</strong> (<em>bool=False</em>) – Whether to write the instantaneous temperature to the file</li>
<li><strong>volume</strong> (<em>bool=False</em>) – Whether to write the periodic box volume to the file</li>
<li><strong>density</strong> (<em>bool=False</em>) – Whether to write the system density to the file</li>
<li><strong>progress</strong> (<em>bool=False</em>) – Whether to write current progress (percent completion) to the file.
If this is True, you must also specify totalSteps.</li>
<li><strong>remainingTime</strong> (<em>bool=False</em>) – Whether to write an estimate of the remaining clock time until
completion to the file.  If this is True, you must also specify
totalSteps.</li>
<li><strong>speed</strong> (<em>bool=False</em>) – Whether to write an estimate of the simulation speed in ns/day to
the file</li>
<li><strong>elapsedTime</strong> (<em>bool=False</em>) – Whether to write the elapsed time of the simulation in seconds to
the file.</li>
<li><strong>separator</strong> (<em>string=’,’</em>) – The separator to use between columns in the file</li>
<li><strong>systemMass</strong> (<em>mass=None</em>) – The total mass to use for the system when reporting density.  If
this is None (the default), the system mass is computed by summing
the masses of all particles.  This parameter is useful when the
particle masses do not reflect their actual physical mass, such as
when some particles have had their masses set to 0 to immobilize
them.</li>
<li><strong>totalSteps</strong> (<em>int=None</em>) – The total number of steps that will be included in the simulation.
This is required if either progress or remainingTime is set to True,
and defines how many steps will indicate 100% completion.</li>
<li><strong>protocolWork</strong> (<em>bool=False,</em>) – Write the protocolWork for the alchemical process in the NCMC simulation</li>
<li><strong>alchemicalLambda</strong> (<em>bool=False,</em>) – Write the alchemicalLambda step for the alchemical process in the NCMC simulation.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="blues.reporters.BLUESStateDataReporter.describeNextReport">
<code class="descname">describeNextReport</code><span class="sig-paren">(</span><em>simulation</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/reporters.html#BLUESStateDataReporter.describeNextReport"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.reporters.BLUESStateDataReporter.describeNextReport" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information about the next report this object will generate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>simulation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">app.Simulation</span></code>) – The simulation to generate a report for</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>nsteps, pos, vel, frc, ene</strong> (<em>int, bool, bool, bool, bool</em>) – nsteps is the number of steps until the next report
pos, vel, frc, and ene are flags indicating whether positions,
velocities, forces, and/or energies are needed from the Context</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.reporters.BLUESStateDataReporter.report">
<code class="descname">report</code><span class="sig-paren">(</span><em>simulation</em>, <em>state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/reporters.html#BLUESStateDataReporter.report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.reporters.BLUESStateDataReporter.report" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a report.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>simulation</strong> (<em>Simulation</em>) – The Simulation to generate a report for</li>
<li><strong>state</strong> (<em>State</em>) – The current state of the simulation</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="blues.reporters.NetCDF4Reporter">
<em class="property">class </em><code class="descclassname">blues.reporters.</code><code class="descname">NetCDF4Reporter</code><span class="sig-paren">(</span><em>file</em>, <em>reportInterval=1</em>, <em>frame_indices=[]</em>, <em>crds=True</em>, <em>vels=False</em>, <em>frcs=False</em>, <em>protocolWork=False</em>, <em>alchemicalLambda=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/reporters.html#NetCDF4Reporter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.reporters.NetCDF4Reporter" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to read or write NetCDF trajectory files
Inherited from <cite>parmed.openmm.reporters.NetCDFReporter</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>file</strong> (<em>str</em>) – Name of the file to write the trajectory to</li>
<li><strong>reportInterval</strong> (<em>int</em>) – How frequently to write a frame to the trajectory</li>
<li><strong>frame_indices</strong> (<em>list, frame numbers for writing the trajectory</em>) – If this reporter is used for the NCMC simulation,
0.5 will report at the moveStep and -1 will record at the last frame.</li>
<li><strong>crds</strong> (<em>bool=True</em>) – Should we write coordinates to this trajectory? (Default True)</li>
<li><strong>vels</strong> (<em>bool=False</em>) – Should we write velocities to this trajectory? (Default False)</li>
<li><strong>frcs</strong> (<em>bool=False</em>) – Should we write forces to this trajectory? (Default False)</li>
<li><strong>protocolWork</strong> (<em>bool=False,</em>) – Write the protocolWork for the alchemical process in the NCMC simulation</li>
<li><strong>alchemicalLambda</strong> (<em>bool=False,</em>) – Write the alchemicalLambda step for the alchemical process in the NCMC simulation.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="blues.reporters.NetCDF4Reporter.describeNextReport">
<code class="descname">describeNextReport</code><span class="sig-paren">(</span><em>simulation</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/reporters.html#NetCDF4Reporter.describeNextReport"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.reporters.NetCDF4Reporter.describeNextReport" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information about the next report this object will generate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>simulation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">app.Simulation</span></code>) – The simulation to generate a report for</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>nsteps, pos, vel, frc, ene</strong> (<em>int, bool, bool, bool, bool</em>) – nsteps is the number of steps until the next report
pos, vel, frc, and ene are flags indicating whether positions,
velocities, forces, and/or energies are needed from the Context</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="blues.reporters.NetCDF4Reporter.report">
<code class="descname">report</code><span class="sig-paren">(</span><em>simulation</em>, <em>state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/reporters.html#NetCDF4Reporter.report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.reporters.NetCDF4Reporter.report" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a report.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>simulation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">app.Simulation</span></code>) – The Simulation to generate a report for</li>
<li><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">mm.State</span></code>) – The current state of the simulation</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-blues.formats">
<span id="formats"></span><h2>Formats<a class="headerlink" href="#module-blues.formats" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="blues.formats.LoggerFormatter">
<em class="property">class </em><code class="descclassname">blues.formats.</code><code class="descname">LoggerFormatter</code><a class="reference internal" href="_modules/blues/formats.html#LoggerFormatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.formats.LoggerFormatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Formats the output of the <cite>logger.Logger</cite> object. Allows customization
for customized logging levels. This will add a custom level ‘REPORT’
to all custom BLUES reporters from the <cite>blues.reporters</cite> module.</p>
<p class="rubric">Examples</p>
<p>Below we add a custom level ‘REPORT’ and have the logger module stream the
message to <cite>sys.stdout</cite> without any additional information to our custom
reporters from the <cite>blues.reporters</cite> module</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">blues</span> <span class="k">import</span> <span class="n">reporters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">blues.formats</span> <span class="k">import</span> <span class="n">LoggerFormatter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">logging</span><span class="o">,</span> <span class="nn">sys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reporters</span><span class="o">.</span><span class="n">addLoggingLevel</span><span class="p">(</span><span class="s1">&#39;REPORT&#39;</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fmt</span> <span class="o">=</span> <span class="n">LoggerFormatter</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stdout_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stdout_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">stdout_handler</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s1">&#39;This is a REPORT call&#39;</span><span class="p">)</span>
<span class="go">    This is a REPORT call</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;This is an INFO call&#39;</span><span class="p">)</span>
<span class="go">    INFO: This is an INFO call</span>
</pre></div>
</div>
<dl class="method">
<dt id="blues.formats.LoggerFormatter.format">
<code class="descname">format</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/formats.html#LoggerFormatter.format"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.formats.LoggerFormatter.format" title="Permalink to this definition">¶</a></dt>
<dd><p>Format the specified record as text.</p>
<p>The record’s attribute dictionary is used as the operand to a
string formatting operation which yields the returned string.
Before formatting the dictionary, a couple of preparatory steps
are carried out. The message attribute of the record is computed
using LogRecord.getMessage(). If the formatting string uses the
time (as determined by a call to usesTime(), formatTime() is
called to format the event time. If there is exception information,
it is formatted using formatException() and appended to the message.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="blues.formats.BLUESHDF5TrajectoryFile">
<em class="property">class </em><code class="descclassname">blues.formats.</code><code class="descname">BLUESHDF5TrajectoryFile</code><span class="sig-paren">(</span><em>filename</em>, <em>mode='r'</em>, <em>force_overwrite=True</em>, <em>compression='zlib'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/formats.html#BLUESHDF5TrajectoryFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.formats.BLUESHDF5TrajectoryFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Extension of the <cite>mdtraj.formats.hdf5.HDF5TrajectoryFile</cite> class which
handles the writing of the trajectory data to the HDF5 file format.
Additional features include writing NCMC related data to the HDF5 file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>str</em>) – The filename for the HDF5 file.</li>
<li><strong>mode</strong> (<em>str, default=’r’</em>) – The mode to open the HDF5 file in.</li>
<li><strong>force_overwrite</strong> (<em>bool, default=True</em>) – If True, overwrite the file if it already exists</li>
<li><strong>compression</strong> (<em>str, default=’zlib’</em>) – Valid choices are [‘zlib’, ‘lzo’, ‘bzip2’, ‘blosc’]</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="blues.formats.BLUESHDF5TrajectoryFile.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>coordinates</em>, <em>parameters=None</em>, <em>environment=None</em>, <em>time=None</em>, <em>cell_lengths=None</em>, <em>cell_angles=None</em>, <em>velocities=None</em>, <em>kineticEnergy=None</em>, <em>potentialEnergy=None</em>, <em>temperature=None</em>, <em>alchemicalLambda=None</em>, <em>protocolWork=None</em>, <em>title=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/formats.html#BLUESHDF5TrajectoryFile.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.formats.BLUESHDF5TrajectoryFile.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write one or more frames of data to the file
This method saves data that is associated with one or more simulation
frames. Note that all of the arguments can either be raw numpy arrays
or unitted arrays (with simtk.unit.Quantity). If the arrays are unittted,
a unit conversion will be automatically done from the supplied units
into the proper units for saving on disk. You won’t have to worry about
it.</p>
<p>Furthermore, if you wish to save a single frame of simulation data, you
can do so naturally, for instance by supplying a 2d array for the
coordinates and a single float for the time. This “shape deficiency”
will be recognized, and handled appropriately.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>coordinates</strong> (<em>np.ndarray, shape=(n_frames, n_atoms, 3)</em>) – The cartesian coordinates of the atoms to write. By convention, the
lengths should be in units of nanometers.</li>
<li><strong>time</strong> (<em>np.ndarray, shape=(n_frames,), optional</em>) – You may optionally specify the simulation time, in picoseconds
corresponding to each frame.</li>
<li><strong>cell_lengths</strong> (<em>np.ndarray, shape=(n_frames, 3), dtype=float32, optional</em>) – You may optionally specify the unitcell lengths.
The length of the periodic box in each frame, in each direction,
<cite>a</cite>, <cite>b</cite>, <cite>c</cite>. By convention the lengths should be in units
of angstroms.</li>
<li><strong>cell_angles</strong> (<em>np.ndarray, shape=(n_frames, 3), dtype=float32, optional</em>) – You may optionally specify the unitcell angles in each frame.
Organized analogously to cell_lengths. Gives the alpha, beta and
gamma angles respectively. By convention, the angles should be
in units of degrees.</li>
<li><strong>velocities</strong> (<em>np.ndarray, shape=(n_frames, n_atoms, 3), optional</em>) – You may optionally specify the cartesian components of the velocity
for each atom in each frame. By convention, the velocities
should be in units of nanometers / picosecond.</li>
<li><strong>kineticEnergy</strong> (<em>np.ndarray, shape=(n_frames,), optional</em>) – You may optionally specify the kinetic energy in each frame. By
convention the kinetic energies should b in units of kilojoules per
mole.</li>
<li><strong>potentialEnergy</strong> (<em>np.ndarray, shape=(n_frames,), optional</em>) – You may optionally specify the potential energy in each frame. By
convention the kinetic energies should b in units of kilojoules per
mole.</li>
<li><strong>temperature</strong> (<em>np.ndarray, shape=(n_frames,), optional</em>) – You may optionally specify the temperature in each frame. By
convention the temperatures should b in units of Kelvin.</li>
<li><strong>alchemicalLambda</strong> (<em>np.ndarray, shape=(n_frames,), optional</em>) – You may optionally specify the alchemicalLambda in each frame. These
have no units, but are generally between zero and one.</li>
<li><strong>protocolWork</strong> (<em>np.ndarray, shape=(n_frames,), optional</em>) – You may optionally specify the protocolWork in each frame. These
are in reduced units of kT but are stored dimensionless</li>
<li><strong>title</strong> (<em>str</em>) – Title of the HDF5 trajectory file</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="blues.formats.NetCDF4Traj">
<em class="property">class </em><code class="descclassname">blues.formats.</code><code class="descname">NetCDF4Traj</code><span class="sig-paren">(</span><em>fname</em>, <em>mode='r'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/formats.html#NetCDF4Traj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.formats.NetCDF4Traj" title="Permalink to this definition">¶</a></dt>
<dd><p>Extension of <cite>parmed.amber.netcdffiles.NetCDFTraj</cite> to allow proper file
flushing. Requires the netcdf4 library (not scipy), install with
<cite>conda install -c conda-forge netcdf4</cite> .</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fname</strong> (<em>str</em>) – File name for the trajectory file</li>
<li><strong>mode</strong> (<em>str, default=’r’</em>) – The mode to open the file in.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="blues.formats.NetCDF4Traj.flush">
<code class="descname">flush</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/formats.html#NetCDF4Traj.flush"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.formats.NetCDF4Traj.flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Flush buffered data to disc.</p>
</dd></dl>

<dl class="classmethod">
<dt id="blues.formats.NetCDF4Traj.open_new">
<em class="property">classmethod </em><code class="descname">open_new</code><span class="sig-paren">(</span><em>fname</em>, <em>natom</em>, <em>box</em>, <em>crds=True</em>, <em>vels=False</em>, <em>frcs=False</em>, <em>remd=None</em>, <em>remd_dimension=None</em>, <em>title=''</em>, <em>protocolWork=False</em>, <em>alchemicalLambda=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/formats.html#NetCDF4Traj.open_new"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.formats.NetCDF4Traj.open_new" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens a new NetCDF file and sets the attributes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fname</strong> (<em>str</em>) – Name of the new file to open (overwritten)</li>
<li><strong>natom</strong> (<em>int</em>) – Number of atoms in the restart</li>
<li><strong>box</strong> (<em>bool</em>) – Indicates if cell lengths and angles are written to the NetCDF file</li>
<li><strong>crds</strong> (<em>bool, default=True</em>) – Indicates if coordinates are written to the NetCDF file</li>
<li><strong>vels</strong> (<em>bool, default=False</em>) – Indicates if velocities are written to the NetCDF file</li>
<li><strong>frcs</strong> (<em>bool, default=False</em>) – Indicates if forces are written to the NetCDF file</li>
<li><strong>remd</strong> (<em>str, default=None</em>) – ‘T[emperature]’ if replica temperature is written
‘M[ulti]’ if Multi-D REMD information is written
None if no REMD information is written</li>
<li><strong>remd_dimension</strong> (<em>int, default=None</em>) – If remd above is ‘M[ulti]’, this is how many REMD dimensions exist</li>
<li><strong>title</strong> (<em>str, default=’‘</em>) – The title of the NetCDF trajectory file</li>
<li><strong>protocolWork</strong> (<em>bool, default=False</em>) – Indicates if protocolWork from the NCMC simulation should be written
to the NetCDF file</li>
<li><strong>alchemicalLambda</strong> (<em>bool, default=False</em>) – Indicates if alchemicalLambda from the NCMC simulation should be written
to the NetCDF file</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="blues.formats.NetCDF4Traj.protocolWork">
<code class="descname">protocolWork</code><a class="headerlink" href="#blues.formats.NetCDF4Traj.protocolWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Store the accumulated protocolWork from the NCMC simulation as property.</p>
</dd></dl>

<dl class="method">
<dt id="blues.formats.NetCDF4Traj.add_protocolWork">
<code class="descname">add_protocolWork</code><span class="sig-paren">(</span><em>stuff</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/formats.html#NetCDF4Traj.add_protocolWork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.formats.NetCDF4Traj.add_protocolWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the time to the current frame of the NetCDF file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>stuff</strong> (<em>float or time-dimension Quantity</em>) – The time to add to the current frame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="blues.formats.NetCDF4Traj.alchemicalLambda">
<code class="descname">alchemicalLambda</code><a class="headerlink" href="#blues.formats.NetCDF4Traj.alchemicalLambda" title="Permalink to this definition">¶</a></dt>
<dd><p>Store the current alchemicalLambda (0-&gt;1.0) from the NCMC simulation as property.</p>
</dd></dl>

<dl class="method">
<dt id="blues.formats.NetCDF4Traj.add_alchemicalLambda">
<code class="descname">add_alchemicalLambda</code><span class="sig-paren">(</span><em>stuff</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blues/formats.html#NetCDF4Traj.add_alchemicalLambda"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#blues.formats.NetCDF4Traj.add_alchemicalLambda" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the time to the current frame of the NetCDF file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>stuff</strong> (<em>float or time-dimension Quantity</em>) – The time to add to the current frame</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorial.html" class="btn btn-neutral float-right" title="Tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Samuel C. Gill, Nathan M. Lim, Kalistyn Burley, David L. Mobley.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.2.2',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>